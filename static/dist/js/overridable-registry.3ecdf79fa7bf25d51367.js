"use strict";(self.webpackChunkinvenio_assets=self.webpackChunkinvenio_assets||[]).push([[1246],{26441:(e,t,n)=>{var r=n(80296),i=n(58168),a=n(23029),l=n(92901),o=n(56822),c=n(53954),s=n(85501),d=n(96540),u=n(61225),m=n(5556),f=n.n(m),p=n(17684),b=n(81057),h=n(1489),v=n(11990),g=n(64467),A=n(3487);function E(e,t,n){return t=(0,c.A)(t),(0,o.A)(e,y()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}var F=function(e){function t(){var e;(0,a.A)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=E(this,t,[].concat(r)),(0,g.A)(e,"handlePublicButtonClick",(function(){var t=e.props,n=t.formik,r=t.fieldPath;n.form.setFieldValue(r,"public"),n.form.setFieldValue("access.embargo",{active:!1})})),(0,g.A)(e,"handleRestrictionButtonClick",(function(){var t=e.props,n=t.formik,r=t.fieldPath;n.form.setFieldValue(r,"restricted")})),e}return(0,s.A)(t,e),(0,l.A)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.formik,n=e.disabled,r=e.fieldPath;n&&t.form.setFieldValue(r,"restricted")}},{key:"render",value:function(){var e=this.props,t=e.active,n=e.disabled,r=t?"positive":"",i=t?"":"negative";return d.createElement(A.A.Group,{widths:"2"},d.createElement(A.A,{className:r,"data-testid":"protection-buttons-component-public",disabled:n,onClick:this.handlePublicButtonClick,active:t},v.M.t("Public")),d.createElement(A.A,{className:i,"data-testid":"protection-buttons-component-restricted",active:!t,onClick:this.handleRestrictionButtonClick},v.M.t("Restricted")))}}])}(d.Component);F.propTypes={fieldPath:f().string.isRequired,formik:f().object.isRequired,active:f().bool,disabled:f().bool},F.defaultProps={active:!0,disabled:!1};var w=function(e){function t(){return(0,a.A)(this,t),E(this,t,arguments)}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return d.createElement(p.FastField,{name:t,component:function(t){return d.createElement(F,(0,i.A)({formik:t},e.props))}})}}])}(d.Component);w.propTypes={fieldPath:f().string.isRequired};var C=n(53196),P=n(80501),R=n(76217),M=function(e){var t="public"===e.recordAccess,n="public"===e.communityAccess;return d.createElement(C.default,(0,i.A)({id:"ReactInvenioDeposit.MetadataAccess.layout"},e),d.createElement(P.A.Field,null,d.createElement("label",{htmlFor:"access.record",className:"invenio-field-label"},d.createElement(R.A,{name:"lock"}),v.M.t("Record access")),d.createElement(w,{active:t&&n,disabled:!n,fieldPath:"access.record"})))};M.propTypes={recordAccess:f().string.isRequired,communityAccess:f().string.isRequired};var O=function(e){var t=e.access,n=e.accessCommunity,r=e.metadataOnly,i="public"===t.files,a="public"===t.record,l="public"===n,o=!r&&l&&a;return r?null:d.createElement(d.Fragment,null,o&&d.createElement(P.A.Field,null,d.createElement("label",{htmlFor:"access.files",className:"invenio-field-label"},d.createElement(R.A,{name:"lock"}),v.M.t("Files access")),d.createElement(w,{active:i,disable:!l,fieldPath:"access.files"})))};O.propTypes={access:f().object.isRequired,metadataOnly:f().bool,accessCommunity:f().string.isRequired},O.defaultProps={metadataOnly:!1};var k=n(62193),I=n.n(k),S=n(91272),x=n(27859),q=n(36713);function D(e){var t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.placeholder,a=e.required,l=e.helpText;return d.createElement(b.TextField,{fieldPath:t,label:d.createElement(b.FieldLabel,{htmlFor:t,icon:r,label:n}),placeholder:i,required:a,helpText:l})}D.propTypes={fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,placeholder:f().string,required:f().bool,helpText:f().string},D.defaultProps={required:!1,labelIcon:"calendar",placeholder:v.M.t("YYYY-MM-DD"),label:v.M.t("Embargo until"),helpText:"".concat(v.M.t("Format"),": ").concat(v.M.t("YYYY-MM-DD"))};var T=n(52822),j=function(e){var t,n,r,i=e.access,a=e.accessCommunity,l=e.metadataOnly,o=(0,p.useFormikContext)().setFieldValue;console.log("EmbargoAccess.js: access",i);var c="public"===i.record,s="public"===i.files,u="public"===a,m=!l&&!s,f=(null===(t=i.embargo)||void 0===t?void 0:t.active)||!1,h=null===(n=i.embargo)||void 0===n?void 0:n.until,g=null===(r=i.embargo)||void 0===r?void 0:r.reason,E=!f&&!I()(h),y=u&&(!c||m),F=h?S.DateTime.fromISO(h).toLocaleString(S.DateTime.DATE_FULL):"???",w=f?"":"positive",C=f?"negative":"";return d.createElement(d.Fragment,null,d.createElement(P.A.Field,null,d.createElement("label",{htmlFor:"access.embargo.active",className:"invenio-field-label"},d.createElement(R.A,{name:"clock outline"}),v.M.t("Apply an embargo")),d.createElement(A.A.Group,{widths:"2"},d.createElement(A.A,{className:"".concat(w,' {!embargoEnabled ? "disabled" : ""}'),disabled:!y,onClick:function(){o("access.files","public"),o("access.embargo",{active:!1})},active:!f},s?v.M.t("Unrestricted"):v.M.t("Not time limited")),d.createElement(A.A,{active:f,onClick:function(){o("access.files","restricted"),o("access.embargo",{active:!0})},disabled:!y,className:"".concat(C,' {!embargoEnabled ? "disabled" : ""}')},v.M.t("Embargoed")))),d.createElement(x.A,{divided:!0,relaxed:!0},d.createElement(x.A.Content,null,d.createElement(x.A.Header,{as:"label",htmlFor:"access.embargo.active"}),!l&&s&&!f&&d.createElement(x.A.Description,null,d.createElement(T.x,null,"Record or files access must be ",d.createElement("b",null,"restricted")," to apply an embargo.")),f&&d.createElement(d.Fragment,null,d.createElement(q.A,{hidden:!0,className:"rel-mb-1"}),d.createElement(D,{fieldPath:"access.embargo.until",required:!0}),d.createElement(b.TextAreaField,{label:v.M.t("Embargo reason"),fieldPath:"access.embargo.reason",placeholder:v.M.t("Optionally, describe the reason for the embargo."),optimized:"true"})),E&&d.createElement(d.Fragment,null,d.createElement(q.A,{hidden:!0}),d.createElement("p",null,v.M.t("Embargo was lifted on {{fmtDate}}.",{fmtDate:F})),g&&d.createElement("p",null,d.createElement("b",null,v.M.t("Reason")),": ",g,".")))))};j.propTypes={access:f().object.isRequired,metadataOnly:f().bool,accessCommunity:f().string.isRequired},j.defaultProps={metadataOnly:!1};var L=n(87395),z=function(e){var t,n,r=e.access,i=e.metadataOnly,a=e.accessCommunity,l="public"===r.record,o="public"===r.files,c="public"===a,s=(null===(t=r.embargo)||void 0===t?void 0:t.active)||!1,u=!c||!l&&!s,m=c&&l&&(i||o),f=s&&!o&&l,p=!s&&!o&&l,b=!l&&s,h=null!==(n=r.embargo)&&void 0!==n&&n.until?S.DateTime.fromISO(r.embargo.until).toLocaleString(S.DateTime.DATE_FULL):"???";return m?d.createElement(L.A,{icon:!0,positive:!0,visible:!0,"data-testid":"access-message"},d.createElement(R.A,{name:"lock open"}),d.createElement(L.A.Content,null,d.createElement(L.A.Header,null,v.M.t("Public")),i?v.M.t("The record is publicly accessible."):v.M.t("The record and files are publicly accessible."))):b?d.createElement(L.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},d.createElement(R.A,{name:"lock"}),d.createElement(L.A.Content,null,d.createElement(L.A.Header,null,v.M.t("Embargoed (full record)")),d.createElement(T.x,{i18nKey:"access-message"},"On ",d.createElement("b",null,h)," the record will automatically be made publicly accessible. Until then, the record can ",d.createElement("b",null,"only")," be accessed by"," ",d.createElement("b",null,"users specified"),' in the permissions."'))):u?d.createElement(L.A,{icon:!0,negative:!0,visible:!0,"data-testid":"access-message"},d.createElement(R.A,{name:"lock"}),d.createElement(L.A.Content,null,d.createElement(L.A.Header,null,v.M.t("Restricted")),d.createElement(T.x,null,"The record can ",d.createElement("b",null,"only")," be accessed by ",d.createElement("b",null,"users specified")," in the permissions."))):p?d.createElement(L.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},d.createElement(R.A,{name:"lock"}),d.createElement(L.A.Content,null,d.createElement(L.A.Header,null,v.M.t("Public with restricted files")),d.createElement(T.x,null,"The record is publicly accessible. The files can ",d.createElement("b",null,"only")," be accessed by"," ",d.createElement("b",null,"users specified")," in the permissions."))):f?d.createElement(L.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},d.createElement(R.A,{name:"lock"}),d.createElement(L.A.Content,null,d.createElement(L.A.Header,null,v.M.t("Embargoed (files-only)")),d.createElement(T.x,{defaults:"The record is publicly accessible. On <bold>{{ date }}</bold> the files will automatically be made publicly accessible. Until then, the files can <bold>only</bold> be accessed by <bold>users specified</bold> in the permissions.",values:{date:h},components:{bold:d.createElement("b",null)}}))):void 0};function N(e,t,n){return t=(0,c.A)(t),(0,o.A)(e,_()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}z.propTypes={access:f().object.isRequired,metadataOnly:f().bool,accessCommunity:f().string.isRequired},z.defaultProps={metadataOnly:!1};var B=function(e){function t(){return(0,a.A)(this,t),N(this,t,arguments)}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.formik,r=e.label,i=void 0===r?v.M.t("Access Permissions"):r,a=e.labelIcon,l=e.showMetadataAccess,o=e.community,c=!0===(null===o||void 0===o?void 0:o.is_ghost),s=o&&!c&&o.access.visibility||"public",u=!n.form.values.files.enabled;return d.createElement(d.Fragment,null,d.createElement("label",{htmlFor:t,className:"field-label-class invenio-field-label"},a&&d.createElement("i",{className:"".concat(a," icon")}),i),d.createElement(h.A,null,d.createElement(h.A.Row,null,d.createElement(h.A.Column,{width:"8"},l&&d.createElement(M,{recordAccess:n.field.value.record,communityAccess:s}),d.createElement(O,{access:n.field.value,accessCommunity:s,metadataOnly:u}),d.createElement(j,{access:n.field.value,accessCommunity:s,metadataOnly:u})),d.createElement(h.A.Column,{width:"8"},d.createElement(z,{access:n.field.value,accessCommunity:s,metadataOnly:u})))))}}])}(d.Component);B.propTypes={fieldPath:f().string.isRequired,formik:f().object.isRequired,label:f().string.isRequired,labelIcon:f().string.isRequired,showMetadataAccess:f().bool,community:f().object},B.defaultProps={showMetadataAccess:!0,community:void 0};var U=(0,u.connect)((function(e){return{community:e.deposit.editorState.selectedCommunity}}),null)(B),V=function(e){function t(){return(0,a.A)(this,t),N(this,t,arguments)}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return d.createElement(p.Field,{name:t},(function(t){return d.createElement(U,(0,i.A)({formik:t},e.props))}))}}])}(d.Component);V.propTypes={fieldPath:f().string.isRequired,label:f().string.isRequired,labelIcon:f().string,isMetadataOnly:f().bool},V.defaultProps={labelIcon:void 0,isMetadataOnly:void 0};var H=n(80045),Y=n(45458),G=n(28085),Q=n(58156),K=n.n(Q),$=n(27041),J=n(48423),W=n(15941),Z=n(7309),X=n.n(Z),ee=n(55378),te=n.n(ee);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e,t,n){return t=(0,c.A)(t),(0,o.A)(e,ae()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function ae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ae=function(){return!!e})()}var le=function(e){function t(){var e;(0,a.A)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=ie(this,t,[].concat(r)),(0,g.A)(e,"serializeAffiliations",(function(e){return e.map((function(e){return re(re({text:e.acronym?"".concat(e.name," (").concat(e.acronym,")"):e.name,value:e.name,key:e.name},e.id?{id:e.id}:{}),{},{name:e.name})}))})),e}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fieldPath,r=t.selectRef;return d.createElement(p.Field,{name:n},(function(t){var i=t.form.values;return d.createElement(b.RemoteSelectField,{fieldPath:n,suggestionAPIUrl:"/api/affiliations",suggestionAPIHeaders:{Accept:"application/json"},initialSuggestions:(0,p.getIn)(i,n,[]),serializeSuggestions:e.serializeAffiliations,placeholder:v.M.t("Search or enter an organization"),label:d.createElement(b.FieldLabel,{htmlFor:"".concat(n,".name"),label:v.M.t("Affiliations")}),noQueryMessage:v.M.t("Search for organizations.."),allowAdditions:!0,clearable:!0,multiple:!0,onValueChange:function(e,t){e.formikProps.form.setFieldValue(n,t)},value:(0,p.getIn)(i,n,[]).map((function(e){return e.name})),ref:r})}))}}])}(d.Component);le.propTypes={fieldPath:f().string.isRequired,selectRef:f().object},le.defaultProps={selectRef:void 0};n(99786);var oe=n(21095),ce={scheme:"",identifier:""},se={orcid:{text:"ORCID",value:"orcid",key:"orcid"},isni:{text:"ISNI",value:"isni",key:"isni"},gnd:{text:"GND",value:"gnd",key:"gnd"},ror:{text:"ROR",value:"ror",key:"ror"}},de=function(e){var t=e.fieldPath,n=e.label,i=void 0===n?v.M.t("Name identifiers"):n,a=(e.placeholder,e.idTypes),l=void 0===a?["orcid","isni","gnd","ror"]:a,o=(0,d.useState)(-1),c=(0,r.A)(o,2),s=c[0],u=c[1],m=(0,d.useState)(!1),f=(0,r.A)(m,2),h=(f[0],f[1]);return d.createElement(d.Fragment,null,d.createElement(b.FieldLabel,{htmlFor:"".concat(t),label:i}),d.createElement(p.FieldArray,{addButtonLabel:v.M.t("Add other titles"),name:t,className:"creator-identifiers",render:function(e){var n;return d.createElement(d.Fragment,null,null===(n=e.form.values.person_or_org.identifiers)||void 0===n?void 0:n.map((function(n,r){console.log("option",n),console.log("arrayHelpers",e);var i="".concat(t,".").concat(r);return console.log("fieldPathPrefix",i),d.createElement(P.A.Group,{key:r,inline:!0,className:"creatibutors-identifiers-item-row"},d.createElement(oe.A,{fieldPath:"".concat(i,".identifier"),name:"".concat(i,".identifier"),id:"".concat(i,".identifier"),label:"",width:10}),d.createElement(b.SelectField,{fieldPath:"".concat(i,".scheme"),name:"".concat(i,".scheme"),id:"".concat(i,".scheme"),label:"Scheme",options:l.map((function(e){return se[e]})),selection:!0,selectOnBlur:!0,optimized:!0,width:4}),d.createElement(P.A.Field,null,d.createElement(A.A,{"aria-label":v.M.t("Remove item"),className:"close-btn",icon:!0,onClick:function(){return function(e,t){h(!0),e.remove(t),u(s-1)}(e,r)}},d.createElement(R.A,{name:"close"}))))})),d.createElement(A.A,{type:"button",onClick:function(){return function(e,t){h(!0),e.push(t),u(s+1)}(e,ce)},icon:!0,className:"align-self-end add-btn creatibutors-identifiers-add-button",labelPosition:"left",id:"".concat(t,".add-identifier-button")},d.createElement(R.A,{name:"add"}),"Add identifier"))}}))};de.propTypes={initialOptions:f().arrayOf(f().shape({key:f().string.isRequired,text:f().string.isRequired,value:f().string.isRequired})).isRequired,fieldPath:f().string.isRequired,label:f().string,placeholder:f().string};var ue="personal",me="organizational",fe=void 0;function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(e,t){var n=e.map((function(e){var t="";e.affiliations.forEach((function(n,r){t+=n.name,r<e.affiliations.length-1&&(t+=", ")}));var n=[];return e.identifiers.forEach((function(e){n.push(function(e){var t=null,n=null;if("orcid"===e.scheme)t="/static/images/orcid.svg",n="https://orcid.org/"+e.identifier;else if("gnd"===e.scheme)t="/static/images/gnd-icon.svg",n="https://d-nb.info/gnd/"+e.identifier;else{if("ror"!==e.scheme)return d.createElement(d.Fragment,null,e.scheme,": ",e.identifier);t="/static/images/ror-icon.svg",n="https://ror.org/"+e.identifier}return d.createElement("span",{key:e.identifier},d.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},d.createElement(b.Image,{src:t,className:"inline-id-icon ml-5 mr-5",verticalAlign:"middle"}),e.identifier),";")}(e))})),{text:e.name,value:e.id,extra:e,key:e.id,content:d.createElement($.A,null,d.createElement($.A.Content,null,e.name," ",n.length?d.createElement(d.Fragment,null,"(",n,")"):null),d.createElement($.A.Subheader,null,t))}}));return t&&n.push({text:"Manual entry",value:"Manual entry",extra:"Manual entry",key:"manual-entry",content:d.createElement($.A,{textAlign:"center"},d.createElement($.A.Content,null,d.createElement("p",null,d.createElement(T.x,null,"Couldn't find your person? You can ",d.createElement("a",null,"create a new entry"),"."))))}),n},ve=function(e){return{person_or_org:be(be({type:ue,family_name:"",given_name:""},e.person_or_org),{},{identifiers:K()(e,"person_or_org.identifiers",[])}),affiliations:K()(e,"affiliations",[]),role:K()(e,"role","")}},ge=function(e,t){var n=K()(e,"affiliations",[]);return be(be({},e),{},{affiliations:n})},Ae=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return W.Ik({person_or_org:W.Ik({type:W.Yj(),family_name:W.Yj().when("type",(function(t,n){if(t===ue&&e)return n.required(v.M.t("Surname is a required field."))})),name:W.Yj().when("type",(function(t,n){if(t===me&&e)return n.required(v.M.t("Organization name is a required field."))})),identifiers:W.YO().of(W.Ik().shape({scheme:W.Yj().required("A scheme is required for each identifier"),identifier:W.Yj().when("scheme",{is:"url",then:W.Yj().url("Must be a valid URL (e.g. https://example.com)").required("You must provide a URL or remove this row")}).matches(/(?!\s).+/,{disallowEmptyString:!0,message:"Identifier cannot be blank"}).required("A value is required for each identifier")}))}),role:W.Yj().when("_",(function(t,n){if(!e)return n.required(v.M.t("Role is a required field."))}))})},Ee="add",ye="search_only",Fe="off",we=function(e){var t=e.autocompleteNames,n=e.initialCreatibutor,a=e.isCreator,l=e.parentFieldPath,o=e.roleOptions,c=e.showManualEntry,s=e.showPersonForm,u=e.values,m="person_or_org",f="".concat(m,".family_name"),p="".concat(m,".given_name"),h="".concat(m,".identifiers"),A="".concat(m,".name"),E="".concat(m,".type"),y=(0,d.createRef)(),F=(0,d.createRef)(),w=(0,d.createRef)(),C=(0,d.createRef)(),R=(0,d.createRef)();return d.createElement(P.A,null,d.createElement(P.A.Group,null,d.createElement(b.RadioField,{fieldPath:E,label:v.M.t("Person"),checked:K()(u,E)===ue,value:ue,onChange:function(e){e.formikProps.form.setFieldValue(E,ue)},optimized:!0}),d.createElement(b.RadioField,{fieldPath:E,label:v.M.t("Organization"),checked:K()(u,E)===me,value:me,onChange:function(e){e.formikProps.form.setFieldValue(E,me),w.current?w.current.focus():R.current.focus()},optimized:!0})),K()(u,E,"")===ue?d.createElement("div",null,t!==Fe&&d.createElement(d.Fragment,null,d.createElement("label",{htmlFor:"".concat(l,".person-search-select")},"Search our existing list by name, identifier (e.g., ORCID id), or affiliation; or enter a new person below."),d.createElement(b.RemoteSelectField,{selectOnBlur:!1,selectOnNavigation:!1,searchInput:{autoFocus:I()(n),id:"".concat(l,".person-search-select")},fieldPath:"creators",clearable:!0,multiple:!1,allowAdditions:!1,placeholder:v.M.t("name, identifier, or affiliation..."),noQueryMessage:v.M.t("name, identifier, or affiliation..."),required:!1,search:function(e){return e},suggestionAPIUrl:"/api/names",serializeSuggestions:function(e){return he(e,c)},onValueChange:function(e,t){return function(e,t,n,i){var a=e.formikProps,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"creators";if("manual-entry"===t[0].key)return fe.namesAutocompleteRef.current.setState({suggestions:[],selectedSuggestions:[]}),void fe.setState({showPersonForm:!0});fe.setState({showPersonForm:!0},(function(){var e=t[0].extra.identifiers.map((function(e){return e.identifier})),o=t[0].extra.affiliations.map((function(e){return e})),c="person_or_org",s="".concat(c,".family_name"),d="".concat(c,".given_name"),u="".concat(c,".identifiers"),m=(0,g.A)((0,g.A)((0,g.A)((0,g.A)({},d,t[0].extra.given_name),s,t[0].extra.family_name),u,e),"affiliations",o);Object.entries(m).forEach((function(e){var t=(0,r.A)(e,2),n=t[0],i=t[1];a.form.setFieldValue(n,i)})),n.current.setState({selectedOptions:n.current.valuesToOptions(e)});var f=o.map((function(e){var t=e.name;return{text:t,value:t,key:t,name:t}}));i.current.setState({suggestions:f,selectedSuggestions:f,searchQuery:null,error:!1,open:!1}),window.setTimeout((function(){return document.getElementById("".concat(l,".role-select")).querySelectorAll("input")[0].focus()}),50)}))}({formikProps:e.formikProps},t,F,y)},ref:C})),s&&d.createElement(d.Fragment,null,d.createElement(q.A,null),d.createElement("div",null,d.createElement(P.A.Group,{widths:"equal"},d.createElement(b.TextField,{label:v.M.t("Surname(s)"),placeholder:v.M.t("Surname(s)"),fieldPath:f,required:a,input:{ref:R,autoFocus:!0}}),d.createElement(b.TextField,{label:v.M.t("First name(s)"),placeholder:v.M.t("First name(s)"),fieldPath:p})),d.createElement(de,{fieldPath:h,ref:F,label:"Personal identifiers (ORCID, ISNI, or GND)",idTypes:["orcid","isni","gnd"]})))):d.createElement(d.Fragment,null,d.createElement(q.A,null),d.createElement(b.TextField,{label:v.M.t("Organization name"),placeholder:v.M.t("Organization name"),fieldPath:A,required:a,input:{ref:w}}),d.createElement(de,{initialOptions:K()(u,h,[]),fieldPath:h,label:"Organization identifiers (ROR, ISNI, or GND)",idTypes:["ror","isni","gnd"]})),(K()(u,E)===me||s&&K()(u,E)===ue)&&d.createElement("div",null,d.createElement(b.SelectField,(0,i.A)({fieldPath:"role",label:v.M.t("Role"),options:o,placeholder:v.M.t("Select role")},a&&{clearable:!0},{required:!a,optimized:!0,scrolling:!0,search:!0,id:"".concat(l,".role-select")})),d.createElement(le,{fieldPath:"affiliations",selectRef:y})))},Ce=function(e){var t=e.action,n=e.autocompleteNames,r=e.resetForm,i=e.saveAndContinueLabel,a=e.setAction,l=e.setShowPersonForm,o=e.handleModalClose,c=e.handleSubmit;return d.createElement(d.Fragment,null,d.createElement(A.A,{name:"cancel",onClick:function(){r(),o()},icon:"remove",content:v.M.t("Cancel"),floated:"left"}),t===Ee&&d.createElement(A.A,{name:"submit",onClick:function(){a("saveAndContinue"),l(n!==ye),c()},primary:!0,icon:"checkmark",content:i}),d.createElement(A.A,{name:"submit",onClick:function(){a("saveAndClose"),l(n!==ye),c()},primary:!0,icon:"checkmark",content:v.M.t("Save")}))},Pe=function(e){var t=e.addLabel,n=e.autocompleteNames,i=void 0===n?"search":n,a=(e.editLabel,e.handleModalClose),l=e.initialCreatibutor,o=void 0===l?{}:l,c=e.modalAction,s=e.onCreatibutorChange,u=e.parentFieldPath,m=e.roleOptions,f=void 0===m?[]:m,b=e.schema,h=(0,d.useState)(v.M.t("Save and add another")),g=(0,r.A)(h,2),A=g[0],E=g[1],y=(0,d.useState)(c),F=(0,r.A)(y,2),w=F[0],C=F[1],P=(0,d.useState)(i!==ye||!I()(o)),R=(0,r.A)(P,2),M=R[0],O=R[1],k=i===ye&&!M,S="creators"===b,x=Ae(S);return d.createElement(p.Formik,{initialValues:ve(o),onSubmit:function(e,t){switch(s(ge(e),w),t.setSubmitting(!1),t.resetForm(),w){case"saveAndContinue":E(v.M.t("Added")),setTimeout((function(){E(v.M.t("Save and add another"))}),2e3);break;case"saveAndClose":a()}},validationSchema:x,validateOnChange:!1,validateOnBlur:!1,as:"div"},(function(e){var n=e.values,r=e.resetForm,l=e.handleSubmit;return d.createElement(d.Fragment,null,w===Ee?d.createElement($.A,{as:"h2"},t):null,d.createElement(we,{autocompleteNames:i,initialCreatibutor:o,isCreator:S,parentFieldPath:u,roleOptions:f,showManualEntry:k,showPersonForm:M,values:n}),d.createElement("div",{className:"creatibutors-item-form-buttons"},d.createElement(Ce,{autocompleteNames:i,handleModalClose:a,handleSubmit:l,action:w,resetForm:r,saveAndContinueLabel:A,setAction:C,setShowPersonForm:O})))}))};(function(e){var t=e.addLabel,n=e.autocompleteNames,i=void 0===n?"search":n,a=e.editLabel,l=e.handleModalClose,o=e.handleModalOpen,c=e.initialCreatibutor,s=void 0===c?{}:c,u=e.modalAction,m=e.modalOpen,f=e.onCreatibutorChange,b=e.parentFieldPath,g=e.roleOptions,A=void 0===g?[]:g,E=e.schema,y=e.trigger,F=(0,d.useState)(v.M.t("Save and add another")),w=(0,r.A)(F,2),C=w[0],P=w[1],R=(0,d.useState)(u),M=(0,r.A)(R,2),O=M[0],k=M[1],S=(0,d.useState)(i!==ye||!I()(s)),x=(0,r.A)(S,2),q=x[0],D=x[1],T=i===ye&&!q,j="creators"===E,L=Ae(j);return d.createElement(p.Formik,{initialValues:ve(s),onSubmit:function(e,t){if(f(ge(e)),t.setSubmitting(!1),t.resetForm(),"saveAndContinue"===O)P(v.M.t("Added")),setTimeout((function(){P(v.M.t("Save and add another"))}),2e3)},enableReinitialize:!0,validationSchema:L,validateOnChange:!1,validateOnBlur:!1},(function(e){var n=e.values,r=e.resetForm,c=e.handleSubmit;return d.createElement(J.A,{centered:!1,onOpen:function(){return o()},open:m,trigger:y,onClose:function(){l(),r()},closeIcon:!0,closeOnDimmerClick:!1,className:"deposit-creatibutor-modal"},d.createElement(J.A.Header,{as:"h6",className:"pt-10 pb-10"},d.createElement(h.A,null,d.createElement(h.A.Column,{floated:"left",width:4},d.createElement($.A,{as:"h2"},O===Ee?t:a)))),d.createElement(J.A.Content,null,d.createElement(we,{autocompleteNames:i,initialCreatibutor:s,isCreator:j,parentFieldPath:b,roleOptions:A,showManualEntry:T,showPersonForm:q,values:n})),d.createElement(J.A.Actions,null,d.createElement(Ce,{autocompleteNames:i,handleModalClose:l,handleSubmit:c,action:O,resetForm:r,saveAndContinueLabel:C,setAction:k,setShowPersonForm:D})))}))}).propTypes={schema:f().oneOf(["creators","contributors"]).isRequired,modalAction:f().oneOf(["add","edit"]).isRequired,addLabel:f().string.isRequired,autocompleteNames:f().oneOf(["search","search_only","off"]),editLabel:f().string.isRequired,initialCreatibutor:f().shape({id:f().string,person_or_org:f().shape({family_name:f().string,given_name:f().string,name:f().string,identifiers:f().arrayOf(f().shape({scheme:f().string,identifier:f().string}))}),affiliations:f().array,role:f().string}),trigger:f().object.isRequired,onCreatibutorChange:f().func.isRequired,roleOptions:f().array};var Re=n(82284),Me=n(97177),Oe=n(65522),ke=n(16147),Ie=function(e){var t=e.compKey,n=e.creatibutorDown,i=e.creatibutorUp,a=e.creatibutorsLength,l=e.itemError,o=e.index,c=e.replaceCreatibutor,s=e.removeCreatibutor,u=e.moveCreatibutor,m=e.addLabel,f=e.editLabel,p=e.initialCreatibutor,b=e.displayName,h=e.roleOptions,g=e.schema,E=e.autocompleteNames,y=e.parentFieldPath,F=e.showEditForms,w=e.setShowEditForms,C=(0,d.useRef)(null),P=(0,Me.i)({item:{index:o,type:"creatibutor"}}),R=(0,r.A)(P,3),M=(R[0],R[1]),O=R[2],k=(0,Oe.H)({accept:"creatibutor",hover:function(e,t){if(C.current){var n=e.index,r=o;n!==r&&t.isOver({shallow:!0})&&(u(n,r),e.index=r)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),I=(0,r.A)(k,2),S=I[0].hidden,q=I[1],D=function(){w(F.filter((function(e){return e!==t})))};var T=function e(t){return t&&"object"===(0,Re.A)(t)?e(t[Object.keys(t)[0]]):(t&&"array"===typeof t&&(T=e(l.find((function(e){return![void 0,null].includes(e)})))),t)}(l);return console.log("firstError",T),q(C),d.createElement(ke.o,{innerRef:C,key:t},d.createElement(x.A.Item,{key:t,className:S?"deposit-drag-listitem hidden":"deposit-drag-listitem"},d.createElement(x.A.Content,{floated:"right"},d.createElement(A.A,{size:"mini",primary:!0,type:"button",onClick:F.includes(t)?D:function(){w([].concat((0,Y.A)(F),[t]))},role:"button"},v.M.t(F.includes(t)?"Cancel":"Edit")),d.createElement(A.A,{size:"mini",type:"button",onClick:function(){return s(o)},icon:"close",role:"button","aria-label":v.M.t("Remove contributor"),negative:!0}),d.createElement(A.A,{size:"mini",type:"button",disabled:0===o,onClick:function(){return i(o)},icon:"arrow up",role:"button","aria-label":v.M.t("Move contributor up")}),d.createElement(A.A,{size:"mini",type:"button",disabled:o>=a-1,onClick:function(){return n(o)},icon:"arrow down",role:"button","aria-label":v.M.t("Move contributor down")})),d.createElement(ke.o,{innerRef:M},d.createElement(x.A.Icon,{name:"bars",className:"drag-anchor"})),d.createElement(ke.o,{innerRef:O},d.createElement(d.Fragment,null,d.createElement(x.A.Content,null,d.createElement(x.A.Description,null,d.createElement("span",{className:"creatibutor"},K()(p,"person_or_org.identifiers",[]).some((function(e){return"orcid"===e.scheme}))&&d.createElement("img",{alt:"ORCID logo",className:"inline-id-icon mr-5",src:"/static/images/orcid.svg",width:"16",height:"16"}),K()(p,"person_or_org.identifiers",[]).some((function(e){return"ror"===e.scheme}))&&d.createElement("img",{alt:"ROR logo",className:"inline-id-icon mr-5",src:"/static/images/ror-icon.svg",width:"16",height:"16"}),K()(p,"person_or_org.identifiers",[]).some((function(e){return"gnd"===e.scheme}))&&d.createElement("img",{alt:"GND logo",className:"inline-id-icon mr-5",src:"/static/images/gnd-icon.svg",width:"16",height:"16"}),b," ",function(e,t){if(e){var n,r,i=null!==(n=null===(r=t.find((function(t){return t.value===e})))||void 0===r?void 0:r.text)&&void 0!==n?n:e;return d.createElement(G.A,null,i)}}(null===p||void 0===p?void 0:p.role,h))),T&&d.createElement(G.A,{pointing:"left",prompt:!0},T.scheme?T.scheme:"Invalid identifiers")),T&&d.createElement(G.A,{pointing:"above",prompt:!0},T),F.includes(t)&&d.createElement(Pe,{addLabel:m,autocompleteNames:E,editLabel:f,handleModalClose:D,initialCreatibutor:p,modalAction:"edit",onCreatibutorChange:function(e){c(o,e)},parentFieldPath:y,roleOptions:h,schema:g})))))};Ie.propTypes={compKey:f().string.isRequired,identifiersError:f().array,index:f().number.isRequired,replaceCreatibutor:f().func.isRequired,removeCreatibutor:f().func.isRequired,moveCreatibutor:f().func.isRequired,addLabel:f().node,editLabel:f().node,initialCreatibutor:f().object.isRequired,displayName:f().string,roleOptions:f().array.isRequired,schema:f().string.isRequired,autocompleteNames:f().oneOfType([f().bool,f().string])};var Se=["addButtonLabel","autocompleteNames","currentUserprofile","fieldPath","label","labelIcon","modal","roleOptions","schema"];var xe=function(e,t){var n=e.concat(t.filter((function(t){return!e.some((function(e){return e.text.toLowerCase()===t.text.toLowerCase()}))})));return function(e){for(var t=(0,Y.A)(e),n=function(){var e=i[r],n=t.findIndex((function(t){return t.value===e}));t.unshift.apply(t,(0,Y.A)(t.splice(n,1)))},r=0,i=["projectOrTeamLeader","projectOrTeamMember","collaborator","translator","editor","author"];r<i.length;r++)n();return t.push.apply(t,(0,Y.A)(t.splice(t.findIndex((function(e){return"other"===e.value})),1))),t}(n.sort((function(e,t){return e.text.localeCompare(t.text)})))},qe=function(e){var t=e.addButtonLabel,n=void 0===t?v.M.t("Add creator"):t,r=e.addingSelf,i=e.setAddingSelf,a=e.autocompleteNames,l=void 0===a?"search":a,o=e.config,c=e.currentUserprofile,s=e.description,u=(e.id,e.form),m=u.values,f=u.errors,h=u.initialErrors,g=u.initialValues,E=u.touched,y=e.label,F=void 0===y?v.M.t("Creators"):y,w=e.labelIcon,C=void 0===w?"user":w,M=e.modal,O=void 0===M?{addLabel:v.M.t("Add creator"),editLabel:v.M.t("Edit creator")}:M,k=e.modalOpen,I=e.move,S=e.name,q=e.push,D=e.remove,T=e.replace,j=e.roleOptions,L=e.schema,z=e.setCreatibutorsTouched,N=e.setModalOpen,_=e.showEditForms,B=e.setShowEditForms,U=(0,p.getIn)(m,S,[]),V=(0,p.getIn)(g,S,[]),H=(0,p.getIn)(f,S,null),Y=(0,p.getIn)(h,S,null),Q=(0,p.getIn)(E,S,null),$=H&&Q||U===V&&Y,J=xe(j,o.vocabularies.contributors.role),W=function(){N(!0),z(!0)},Z=function(){z(!0),N(!1),i(!1),X()},X=function(){setTimeout((function(){document.getElementById("".concat(S,".add-button")).focus()}),100)},ee=function(e){e>0&&I(e,e-1)},te=function(e){e<U.length-1&&I(e,e+1)},ne="string"===typeof c.affiliations&&""!==c.affiliations?[c.affiliations]:null===c||void 0===c?void 0:c.affiliations,re={person_or_org:{family_name:r&&((null===c||void 0===c?void 0:c.family_name)||(null===c||void 0===c?void 0:c.full_name))||"",given_name:r&&(null===c||void 0===c?void 0:c.given_name)||"",name:r&&(null===c||void 0===c?void 0:c.full_name)||"",type:"personal"},role:"author",affiliations:r&&(null===ne||void 0===ne?void 0:ne.length)>0?ne.map((function(e){return{text:e,key:e,value:e,name:e}})):[]};return d.createElement(P.A.Field,{required:"creators"===L,className:$?"error":""},d.createElement(b.FieldLabel,{htmlFor:S,icon:C,label:F}),d.createElement(x.A,null,U.map((function(e,t){var n="".concat(S,".").concat(t),r=function(e){var t=K()(e,"person_or_org.type",ue)===ue,n=K()(e,"person_or_org.family_name",""),r=K()(e,"person_or_org.given_name",""),i=K()(e,"affiliations[0].name",""),a=K()(e,"person_or_org.name"),l=i?" (".concat(i,")"):"";if(t){var o=r?", ".concat(r):"";return"".concat(n).concat(o).concat(l)}return"".concat(a).concat(l)}(e);return console.log("key is",n),d.createElement(Ie,{key:n,creatibutorsLength:U.length,creatibutorDown:te,creatibutorUp:ee,itemError:$?H[t]:null,displayName:r,index:t,roleOptions:J,schema:L,compKey:n,initialCreatibutor:e,removeCreatibutor:D,replaceCreatibutor:T,moveCreatibutor:I,addLabel:O.addLabel,editLabel:O.editLabel,autocompleteNames:l,focusAddButtonHandler:X,modalOpen:k,handleModalClose:Z,handleModalOpen:W,parentFieldPath:S,setModalOpen:N,showEditForms:_,setShowEditForms:B})}))),!k&&d.createElement("div",null,d.createElement(A.A,{type:"button",icon:!0,labelPosition:"left",id:"".concat(S,".add-button"),className:"add-button","aria-labelledby":"".concat(S,"-field-description"),onClick:function(){return N(!0)}},d.createElement(R.A,{name:"add"}),n),d.createElement(A.A,{type:"button",icon:!0,labelPosition:"left",id:"".concat(S,".add-button"),className:"add-button","aria-labelledby":"".concat(S,"-field-description"),onClick:function(){i(!0),setTimeout((function(){N(!0)}),100)}},d.createElement(R.A,{name:"add"}),"Add myself")),(k||$&&"string"==typeof $)&&d.createElement(Pe,{onCreatibutorChange:function(e,t){console.log("handleOnContributorChange"),i(!1),q(e),N("saveAndContinue"===t)},addLabel:O.addLabel,editLabel:O.editLabel,roleOptions:J,schema:L,autocompleteNames:l,focusAddButtonHandler:X,parentFieldPath:S,modalOpen:k,handleModalClose:Z,handleModalOpen:W,initialCreatibutor:re,modalAction:"add"}),$&&"string"===typeof H&&d.createElement(G.A,{pointing:"above",prompt:!0},H),d.createElement("span",{id:"".concat(S,"-field-description"),className:"helptext"},s))},De=function(e){var t=e.addButtonLabel,n=void 0===t?v.M.t("Add creator"):t,a=e.autocompleteNames,l=void 0===a?"search":a,o=e.currentUserprofile,c=e.fieldPath,s=e.label,u=void 0===s?void 0:s,m=e.labelIcon,f=void 0===m?void 0:m,b=e.modal,h=void 0===b?{addLabel:v.M.t("Add creator"),editLabel:v.M.t("Edit creator")}:b,g=e.roleOptions,A=void 0===g?void 0:g,E=e.schema,y=void 0===E?"creators":E,F=(0,H.A)(e,Se);console.log("CreatibutorsField called",c,u,f,h,A,y,F);var w=(0,d.useState)(!1),C=(0,r.A)(w,2),P=C[0],R=C[1],M=(0,d.useState)(!1),O=(0,r.A)(M,2),k=O[0],I=O[1],S=(0,d.useState)([]),x=(0,r.A)(S,2),q=x[0],D=x[1],T=(0,d.useState)(!1),j=(0,r.A)(T,2),L=j[0],z=j[1];(0,p.useFormikContext)().setFieldTouched;return(0,d.useEffect)((function(){console.log("useEffect creatibutorsTouched",L)}),[L]),d.createElement(p.FieldArray,{name:c,component:function(e){return d.createElement(qe,(0,i.A)({},e,F,{addButtonLabel:n,addingSelf:k,autocompleteNames:l,currentUserprofile:o,fieldPath:c,label:u,labelIcon:f,modalOpen:P,roleOptions:A,modal:h,schema:y,setAddingSelf:I,setCreatibutorsTouched:z,setModalOpen:R,showEditForms:q,setShowEditForms:D}))}})};qe.propTypes={fieldPath:f().string.isRequired,addButtonLabel:f().string,modal:f().shape({addLabel:f().string.isRequired,editLabel:f().string.isRequired}),schema:f().oneOf(["creators","contributors"]).isRequired,autocompleteNames:f().oneOf(["search","search_only","off"]),label:f().string,labelIcon:f().string,roleOptions:f().array.isRequired,form:f().object.isRequired,remove:f().func.isRequired,replace:f().func.isRequired,move:f().func.isRequired,push:f().func.isRequired,name:f().string.isRequired},De.propTypes={addButtonLabel:f().string,autocompleteNames:f().oneOf(["search","search_only","off"]),fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,modal:f().shape({addLabel:f().string.isRequired,editLabel:f().string.isRequired}),roleOptions:f().array,schema:f().oneOf(["creators","contributors"]).isRequired},De.defaultProps={};var Te=n(93532),je=n(65466),Le={lang:"",description:"",type:""};function ze(e){return e.sort((function(e,t){return e.text.localeCompare(t.text)}))}var Ne=function(e){var t=e.fieldPath,n=e.options,i=e.recordUI,a=void 0===i?{}:i,l=e.editorConfig,o=void 0===l?void 0:l,c=(0,p.useFormikContext)().values,s=(0,d.useState)(-1),u=(0,r.A)(s,2),m=u[0],f=u[1],h=(0,d.useState)(!1),g=(0,r.A)(h,2),E=g[0],y=g[1],F=t.replace(/\./g,"-"),w=d.createRef();(0,d.useLayoutEffect)((function(){var e;E&&(m<0?null===(e=document.getElementById("".concat(t,".add-button")))||void 0===e||e.focus():window.setTimeout((function(){var e=document.querySelectorAll(".additional-description-item-row textarea");e[e.length-1].focus()}),100))}),[m]);var C=function(e,t){y(!0),e.remove(t),f(m-1)};return d.createElement(p.FieldArray,{addButtonLabel:v.M.t("Add another description"),defaultNewValue:Le,name:t,className:"additional-descriptions",render:function(e){return d.createElement(d.Fragment,null,c.metadata.additional_descriptions.map((function(r,i){var l,c="".concat(t,".").concat(i),s="".concat(F,"-").concat(i);return d.createElement("div",{key:i,className:"additional-description-wrapper"},d.createElement(P.A.Group,{className:"additional-description-item-row sixteen wide"},d.createElement(je.f,{fieldPath:"".concat(c,".description"),id:"".concat(c,".description"),label:v.M.t("Additional description"),editorConfig:o,optimized:!0,required:!0,classnames:"fourteen wide tablet sixteen wide mobile twelve wide computer ".concat(s,"-description"),ref:w}),d.createElement(P.A.Field,{className:"mobile hidden two wide"},d.createElement(A.A,{"aria-label":v.M.t("remove field"),className:"close-btn",floated:"right",icon:!0,onClick:function(){return C(e,i)}},d.createElement(R.A,{name:"close"})))),d.createElement(P.A.Group,{className:"sixteen wide equal widths"},d.createElement(b.SelectField,{fieldPath:"".concat(c,".type"),id:"".concat(c,".type"),label:v.M.t("Type of description"),options:ze(n.type),required:!0,optimized:!0,search:!0}),d.createElement(Te.Km,{serializeSuggestions:function(e){return e.map((function(e){return{text:e.title_l10n,value:e.id,fieldPathPrefix:e.id}}))},initialOptions:null!==a&&void 0!==a&&a.additional_descriptions&&null!==(l=a.additional_descriptions[i])&&void 0!==l&&l.lang?[a.additional_descriptions[i].lang]:[],fieldPath:"".concat(c,".lang"),id:"".concat(c,".lang"),label:v.M.t("Language"),multiple:!1,placeholder:v.M.t("select language"),labelIcon:"",clearable:!0,selectOnBlur:!1}),d.createElement(P.A.Field,{tablet:2,computer:2,mobile:0,className:"tablet computer only two wide"}),d.createElement(P.A.Field,{tablet:0,computer:0,mobile:2,className:"mobile only two wide"},d.createElement(A.A,{"aria-label":v.M.t("remove field"),className:"close-btn",floated:"right",icon:!0,onClick:function(){return C(e,i)}},d.createElement(R.A,{name:"close"})))))})),d.createElement(A.A,{type:"button",onClick:function(){return function(e,t){y(!0),e.push(t),f(m+1)}(e,Le)},icon:!0,className:"align-self-end add-btn",labelPosition:"left",id:"".concat(t,".add-button")},d.createElement(R.A,{name:"add"}),"Add another description"))}})};Ne.propTypes={fieldPath:f().string.isRequired,options:f().shape({type:f().arrayOf(f().shape({icon:f().string,text:f().string,value:f().string})),lang:f().arrayOf(f().shape({text:f().string,value:f().string}))}).isRequired,recordUI:f().object,editorConfig:f().object};var _e=function(e){var t=e.classnames,n=e.fieldPath,r=e.label,i=void 0===r?v.M.t("Description"):r,a=e.labelIcon,l=void 0===a?"pencil":a,o=e.options,c=e.editorConfig,s=void 0===c?void 0:c,u=e.recordUI,m=void 0===u?void 0:u;return d.createElement(d.Fragment,null,d.createElement(je.f,{className:"description-field rel-mb-1 ".concat(t),fieldPath:n,editorConfig:s,label:d.createElement(b.FieldLabel,{htmlFor:n,icon:l,label:i}),optimized:!0}),d.createElement(Ne,{recordUI:m,options:o,editorConfig:s,fieldPath:"metadata.additional_descriptions"}))};_e.propTypes={fieldPath:f().string.isRequired,label:f().node,labelIcon:f().string,editorConfig:f().object,recordUI:f().object,options:f().object.isRequired};var Be=n(98871),Ue=n(27089),Ve=n(23848),He=n(73591),Ye=(0,Be.Q2)((function(e){var t=e.currentResultsState,n=e.deserializeAward,r=e.deserializeFunder,i=e.computeFundingContents;return d.createElement(p.FastField,{name:"selectedFunding"},(function(e){var a=e.form,l=a.values,o=a.setFieldValue;return d.createElement(Ve.A.Group,null,t.data.hits.map((function(e){var t=null===e||void 0===e?void 0:e.funder,a=n(e),c={award:a,funder:r(t)},s=i(c),u=s.headerContent,m=s.descriptionContent,f=s.awardOrFunder;return d.createElement(Ve.A,{key:a.id,onClick:function(){return o("selectedFunding",c)},className:"license-item"},d.createElement(He.A,{checked:K()(l,"selectedFunding.award.id")===c.award.id,onChange:function(){return o("selectedFunding",c)}}),d.createElement(Ve.A.Content,{className:"license-item-content"},d.createElement($.A,{size:"small"},u,"award"===f?e.number&&d.createElement(G.A,{basic:!0,size:"mini"},e.number):"","award"===f?e.url&&d.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},d.createElement(R.A,{link:!0,name:"external alternate",className:"spaced-left"})):""),d.createElement(Ve.A.Description,{className:"license-item-description"},m)))})))}))}));function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ke(e){var t=e.deserializeFunder,n=e.selectedFunding;return d.createElement(P.A,null,d.createElement(b.RemoteSelectField,{fieldPath:"selectedFunding.funder.id",suggestionAPIUrl:"/api/funders",suggestionAPIHeaders:{Accept:"application/vnd.inveniordm.v1+json"},placeholder:v.M.t("Search for a funder by name"),serializeSuggestions:function(e){return e.map((function(e){return function(e){var t=null,n=null;return e.name&&(t=e.name),e.pid&&(n=e.pid),t||n?Qe(Qe({text:t||n,value:e.id,key:e.id},t&&{name:t}),n&&{pid:n}):{}}(t(e))}))},searchInput:{autoFocus:I()(n)},label:v.M.t("Funder"),noQueryMessage:v.M.t("Search for funder..."),clearable:!0,allowAdditions:!1,multiple:!1,selectOnBlur:!1,selectOnNavigation:!1,required:!0,search:function(e){return e},onValueChange:function(e,t){var n,r=e.formikProps;if(1===t.length){var i=t[0];if(i){var a=Qe(Qe({id:(n=i).key},n.name&&{name:n.name}),n.pid&&{pid:n.pid});r.form.setFieldValue("selectedFunding.funder",a)}}}}),d.createElement($.A,{as:"h3",size:"small"},v.M.t("Award information")," (",v.M.t("optional"),")"),d.createElement(P.A.Group,{widths:"equal"},d.createElement(b.TextField,{label:v.M.t("Number"),placeholder:v.M.t("Award number"),fieldPath:"selectedFunding.award.number"}),d.createElement(b.TextField,{label:v.M.t("Title"),placeholder:v.M.t("Award Title"),fieldPath:"selectedFunding.award.title"}),d.createElement(b.TextField,{label:v.M.t("URL"),placeholder:v.M.t("Award URL"),fieldPath:"selectedFunding.award.url"})))}Ye.propTypes={deserializeAward:f().func.isRequired,deserializeFunder:f().func.isRequired,computeFundingContents:f().func.isRequired},Ke.propTypes={deserializeFunder:f().func.isRequired,selectedFunding:f().object},Ke.defaultProps={selectedFunding:void 0};const $e=Ke;var Je=n(34667);function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xe=(0,Be.Q2)((function(e){var t=e.currentResultsState,n=e.updateQueryState,i=e.currentQueryState,a=function(e){var t=d.useState([]),n=(0,r.A)(t,2),i=n[0],a=n[1];return d.useEffect((function(){!function(){var t;if(e.loading)a([]);else{var n=null===(t=e.data.aggregations)||void 0===t||null===(t=t.funders)||void 0===t?void 0:t.buckets.map((function(e){return{key:e.key,value:e.key,text:e.label}}));a(n)}}()}),[e]),[i]}(t),l=(0,r.A)(a,1)[0];return d.createElement(Je.A,{placeholder:v.M.t("Funder"),search:!0,selection:!0,clearable:!0,scrolling:!0,multiple:!1,options:l||[],allowAdditions:!1,onChange:function(e,t){var r=[];t&&""!==t.value&&(r=["funders",t.value]),n(Ze(Ze({},i),{},{filters:r,page:1}))},fluid:!0,selectOnBlur:!1,selectOnNavigation:!1})})),et=n(2685);function tt(e){var t=e.switchToCustom;return d.createElement(et.A,{basic:!0,content:d.createElement("p",null,v.M.t("Did not find your award? "),d.createElement("a",{href:"/",onClick:function(e){e.preventDefault(),t()}},v.M.t("Add a custom award.")))})}tt.propTypes={switchToCustom:f().func.isRequired};var nt=["action","mode","trigger","onAwardChange","searchConfig","deserializeAward","deserializeFunder","computeFundingContents","focusAddButtonHandler"],rt="standard",it="custom",at="add",lt="edit",ot=W.Ik().shape({selectedFunding:W.Ik().shape({funder:W.Ik().shape({id:W.Yj().required()}),award:W.Ik().shape({id:W.Yj().required()})})}),ct=W.Ik().shape({selectedFunding:W.Ik().shape({funder:W.Ik().shape({id:W.Yj().required(v.M.t("Funder is required."))}),award:W.Ik().shape({title:W.Yj().test({name:"testTitle",message:v.M.t("Title must be set alongside number."),test:function(e){return!(this.parent.number&&!e)}}),number:W.Yj().test({name:"testNumber",message:v.M.t("Number must be set alongside title."),test:function(e){return!(this.parent.title&&!e)}}),url:W.Yj().url(v.M.t("URL must be valid.")).test({name:"validateUrlDependencies",message:v.M.t("URL must be set alongside title and number."),test:function(e){var t=this.parent,n=t.title,r=t.number;return!(e&&""!==e&&!n&&!r)}})})})});function st(e){var t=e.action,n=e.mode,i=e.trigger,a=e.onAwardChange,l=e.searchConfig,o=e.deserializeAward,c=e.deserializeFunder,s=e.computeFundingContents,u=e.focusAddButtonHandler,m=(0,H.A)(e,nt),f=(0,d.useState)(!1),b=(0,r.A)(f,2),g=b[0],E=b[1],y=(0,d.useState)(n),F=(0,r.A)(y,2),w=F[0],C=F[1],P=function(){return E(!0)},R=function(){C(n),E(!1),u()},M=new Be.HZ(l.searchApi),O=w===it?m.initialFunding:{},k={selectedFunding:t===lt?O:{}},I=w===it?ct:ot;return d.createElement(p.Formik,{initialValues:k,onSubmit:function(e,t){t.setSubmitting(!1),t.resetForm(),C(n),R(),a(e.selectedFunding),u()},validationSchema:I,validateOnChange:!1,validateOnBlur:!1,enableReinitialize:!0},(function(e){var n=e.values,r=e.resetForm,a=e.handleSubmit;return d.createElement(J.A,{role:"dialog",centered:!1,onOpen:P,open:g,trigger:d.cloneElement(i,{"aria-expanded":g,"aria-haspopup":"dialog"}),onClose:R,closeIcon:!0,closeOnDimmerClick:!1},d.createElement(J.A.Header,{as:"h2",className:"pt-10 pb-10"},"standard"===w?v.M.t("Add standard award"):v.M.t("Add custom award")),d.createElement(J.A.Content,null,w===rt&&d.createElement(Be.gz,{searchApi:M,appName:"awards",urlHandlerApi:{enabled:!1},initialQueryState:l.initialQueryState},d.createElement(h.A,{className:"m-0"},d.createElement(h.A.Row,null,d.createElement(h.A.Column,{width:11,floated:"left",verticalAlign:"middle"},d.createElement(Be.IW,{placeholder:v.M.t("Search for awards"),autofocus:!0,actionProps:{icon:"search",content:null,className:"search"}})),d.createElement(h.A.Column,{width:5,floated:"right",textAlign:"right"},d.createElement(Xe,null))),d.createElement(h.A.Column,{width:16,className:"pb-0"},d.createElement(Be.oK,null,d.createElement(Be.i6,null),d.createElement(Be.$D,null),d.createElement(Ye,{deserializeAward:o,deserializeFunder:c,computeFundingContents:s})),d.createElement(Ue.A,{textAlign:"center",className:"rel-mb-1"},d.createElement(Be.dK,null))),d.createElement(h.A.Column,{width:16,textAlign:"center",className:"pt-0 pb-0"},d.createElement(tt,{switchToCustom:function(){r(),C(it)}})))),w===it&&d.createElement($e,{deserializeFunder:c,selectedFunding:n.selectedFunding})),d.createElement(J.A.Actions,null,d.createElement(A.A,{onClick:function(){r(),R()},icon:"remove",content:v.M.t("Cancel"),floated:"left"}),d.createElement(A.A,{onClick:function(e){return a(e)},primary:!0,icon:"checkmark",content:t===at?v.M.t("Add award"):v.M.t("Change award")})))}))}st.propTypes={mode:f().oneOf(["standard","custom"]).isRequired,action:f().oneOf(["add","edit"]).isRequired,trigger:f().object.isRequired,onAwardChange:f().func.isRequired,searchConfig:f().shape({searchApi:f().shape({axios:f().shape({headers:f().object})}).isRequired,initialQueryState:f().object.isRequired}).isRequired,deserializeAward:f().func.isRequired,deserializeFunder:f().func.isRequired,computeFundingContents:f().func.isRequired,initialFunding:f().object},st.defaultProps={initialFunding:void 0};const dt=st;var ut=function(e){var t,n,i=e.compKey,a=e.index,l=e.fundingItem,o=e.awardType,c=e.moveFunding,s=e.replaceFunding,u=e.removeFunding,m=e.searchConfig,f=e.deserializeAward,p=e.deserializeFunder,b=e.computeFundingContents,h=d.useRef(null),g=(0,Me.i)({item:{index:a,type:"award"}}),E=(0,r.A)(g,3),y=(E[0],E[1]),F=E[2],w=(0,Oe.H)({accept:"award",hover:function(e,t){if(h.current){var n=e.index,r=a;n!==r&&t.isOver({shallow:!0})&&(c(n,r),e.index=r)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),C=(0,r.A)(w,2),P=C[0].hidden,M=C[1],O=b(l),k=O.headerContent,I=O.descriptionContent,S=O.awardOrFunder;return M(h),d.createElement(ke.o,{innerRef:h,key:i},d.createElement(x.A.Item,{key:i,className:P?"deposit-drag-listitem hidden":"deposit-drag-listitem"},d.createElement(x.A.Content,{floated:"right"},d.createElement(dt,{searchConfig:m,onAwardChange:function(e){s(a,e)},mode:o,action:"edit",trigger:d.createElement(A.A,{size:"mini",primary:!0,type:"button"},v.M.t("Edit")),deserializeAward:f,deserializeFunder:p,computeFundingContents:b,initialFunding:l}),d.createElement(A.A,{size:"mini",type:"button",onClick:function(){return u(a)}},v.M.t("Remove"))),d.createElement(ke.o,{innerRef:y},d.createElement(x.A.Icon,{name:"bars",className:"drag-anchor"})),d.createElement(ke.o,{innerRef:F},d.createElement(x.A.Content,null,d.createElement(x.A.Header,null,d.createElement(d.Fragment,null,d.createElement("span",{className:"mr-5"},k),"award"===S?(null===l||void 0===l||null===(t=l.award)||void 0===t?void 0:t.number)&&d.createElement(G.A,{basic:!0,size:"mini",className:"mr-5"},l.award.number):"","award"===S?(null===l||void 0===l||null===(n=l.award)||void 0===n?void 0:n.url)&&d.createElement("a",{href:l.award.url,target:"_blank",rel:"noopener noreferrer","aria-label":v.M.t("Open external link")},d.createElement(R.A,{link:!0,name:"external alternate"})):"")),d.createElement(x.A.Description,null,I||d.createElement("br",null))))))};function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e){var t=e.label,n=e.labelIcon,r=e.fieldPath,i=e.form.values,a=e.move,l=e.push,o=e.remove,c=e.replace,s=e.required,u=e.deserializeAward,m=e.deserializeFunder,f=e.computeFundingContents,h=e.searchConfig,g=function(){document.getElementById("".concat(r,".add-button")).focus()},E=u||function(e){var t;return ft(ft({title:null===e||void 0===e?void 0:e.title_l10n,number:e.number,funder:null!==(t=e.funder)&&void 0!==t?t:"",id:e.id},e.identifiers&&{identifiers:e.identifiers}),e.acronym&&{acronym:e.acronym})},y=m||function(e){return ft(ft(ft({id:e.id,name:e.name},e.pid&&{pid:e.pid}),e.country&&{country:e.country}),e.identifiers&&{identifiers:e.identifiers})},F=f||function(e){var t,n="",r="award";if(e.award&&(t=e.award.title),e.funder){var i,a,l,o,c,s,d=null!==(i=null!==(a=null!==(l=null===e||void 0===e||null===(o=e.funder)||void 0===o?void 0:o.name)&&void 0!==l?l:null===(c=e.funder)||void 0===c?void 0:c.title)&&void 0!==a?a:null===e||void 0===e||null===(s=e.funder)||void 0===s?void 0:s.id)&&void 0!==i?i:"";n=d,t||(r="funder",t=d,n="")}return{headerContent:t,descriptionContent:n,awardOrFunder:r}};return d.createElement(P.A.Field,{required:s},d.createElement(b.FieldLabel,{htmlFor:r,icon:n,label:t}),d.createElement(x.A,null,(0,p.getIn)(i,r,[]).map((function(e,t){var n,i="".concat(r,".").concat(t),l=null!==e&&void 0!==e&&null!==(n=e.award)&&void 0!==n&&n.id?"standard":"custom";return d.createElement(ut,{key:i,index:t,compKey:i,fundingItem:e,awardType:l,moveFunding:a,replaceFunding:c,removeFunding:o,searchConfig:h,computeFundingContents:F,deserializeAward:E,deserializeFunder:y})})),d.createElement(dt,{searchConfig:h,trigger:d.createElement(A.A,{type:"button",key:"custom",id:"".concat(r,".add-button"),icon:!0,labelPosition:"left",className:"mb-5 add-button"},d.createElement(R.A,{name:"add"}),v.M.t("Add award from list")),onAwardChange:function(e){l(e)},mode:"standard",action:"add",deserializeAward:E,deserializeFunder:y,computeFundingContents:F,focusAddButtonHandler:g}),d.createElement(dt,{searchConfig:h,trigger:d.createElement(A.A,{type:"button",key:"custom",icon:!0,className:"add-button",labelPosition:"left"},d.createElement(R.A,{name:"add"}),v.M.t("Add custom")),onAwardChange:function(e){l(e)},mode:"custom",action:"add",deserializeAward:E,deserializeFunder:y,computeFundingContents:F,focusAddButtonHandler:g})))}function bt(e){var t=e.fieldPath;return d.createElement(p.FieldArray,{name:t,component:function(t){return d.createElement(pt,(0,i.A)({},t,e))}})}ut.propTypes={compKey:f().any,index:f().number,fundingItem:f().object,awardType:f().string,moveFunding:f().func.isRequired,replaceFunding:f().func.isRequired,removeFunding:f().func.isRequired,searchConfig:f().object.isRequired,deserializeAward:f().func.isRequired,deserializeFunder:f().func.isRequired,computeFundingContents:f().func.isRequired},ut.defaultProps={compKey:void 0,index:void 0,fundingItem:void 0,awardType:void 0},pt.propTypes={label:f().node,labelIcon:f().node,fieldPath:f().string.isRequired,form:f().object,move:f().func,push:f().func,remove:f().func,replace:f().func,required:f().bool,deserializeAward:f().func,deserializeFunder:f().func,computeFundingContents:f().func,searchConfig:f().object},pt.defaultProps={label:void 0,labelIcon:void 0,form:void 0,move:void 0,push:void 0,remove:void 0,replace:void 0,required:void 0,deserializeAward:void 0,deserializeFunder:void 0,computeFundingContents:void 0,searchConfig:void 0},bt.propTypes={fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,searchConfig:f().object.isRequired,required:f().bool,deserializeAward:f().func,deserializeFunder:f().func,computeFundingContents:f().func},bt.defaultProps={label:"Awards",labelIcon:"money bill alternate outline",required:!1,deserializeAward:void 0,deserializeFunder:void 0,computeFundingContents:void 0};var ht=n(10182),vt={scheme:"",identifier:""},gt={scheme:"url",identifier:""},At=function(e){var t=e.fieldPath,n=e.description,i=(e.placeholder,e.label),a=void 0===i?v.M.t("Identifiers"):i,l=e.labelIcon,o=void 0===l?"barcode":l,c=e.required,s=void 0!==c&&c,u=e.schemeOptions,m=void 0===u?void 0:u,f=e.showEmptyValue,h=void 0!==f&&f,g=(0,p.useFormikContext)(),E=g.values,y=g.setFieldValue,F=(0,d.useState)(0),w=(0,r.A)(F,2),C=w[0],M=w[1],O=(0,d.useState)(!1),k=(0,r.A)(O,2),I=k[0],S=k[1];v.M.t("Add identifier");(0,d.useEffect)((function(){var e,n;I&&(C<0?null===(e=document.getElementById("".concat(t,".add-url-button")))||void 0===e||e.focus():null===(n=document.getElementById("".concat(t,".").concat(C,".identifier")))||void 0===n||n.focus())}),[C]);var x=function(e,t){S(!0),e.push(t),M(C+1)},q=function(e){var t=e.target.closest(".fields"),n=Array.from(t.querySelectorAll("*"));setTimeout((function(){var e=n.some((function(e){return e.firstElementChild===document.activeElement||document.activeElement.id&&e.id.includes(document.activeElement.id)}));if(E.metadata.identifiers.length&&!e){var t=E.metadata.identifiers.reduce((function(e,t){return""!==t.identifier&&""!==t.scheme&&e.push(t),e}),[]);M(t.length-1),y("metadata.identifiers",t)}}),10)};return d.createElement(p.FieldArray,{name:t,id:t,className:"invenio-array-field",showEmptyValue:h,render:function(e){return d.createElement(d.Fragment,null,d.createElement(P.A.Field,{required:s},d.createElement(b.FieldLabel,{htmlFor:t,icon:o,label:a})),E.metadata.identifiers.map((function(r,i){var a=r.scheme,l=r.identifier,c="".concat(t,".").concat(i),s="url"===a,u=!!l||""!==l,f=!!a||""!==a;return d.createElement(P.A.Group,{id:"".concat(t,".").concat(i),key:i,className:"identifier-item-row",onBlur:function(e){q(e)}},d.createElement(oe.A,{fieldPath:"".concat(c,".identifier"),label:d.createElement("label",null,d.createElement(R.A,{name:s?"linkify":o}),v.M.t(s?"URL":"Identifier")),required:!s&&f,id:"".concat(c,".identifier"),width:s?14:9,fluid:!1,onBlur:function(e){q(e)}}),m&&!s&&d.createElement(ht.z,{fieldPath:"".concat(c,".scheme"),id:"".concat(c,".scheme"),label:v.M.t("Scheme"),options:m,optimized:!0,required:!s&&u,width:5}),!m&&d.createElement(oe.A,{fieldPath:"".concat(c,".scheme"),id:"".concat(c,".scheme"),label:v.M.t("Scheme"),required:!0,width:5,fluid:!1}),d.createElement(P.A.Field,{width:2},d.createElement(A.A,{"aria-label":v.M.t("Remove field"),className:"close-btn",icon:"close",onClick:function(){return function(e,t){S(!0),e.remove(t),M(C-1)}(e,i)}})),n&&d.createElement("label",{className:"helptext mb-0"},n))})),d.createElement(A.A,{type:"button",onClick:function(){return x(e,gt)},icon:!0,className:"align-self-end add-button",labelPosition:"left",id:"".concat(t,".add-url-button")},d.createElement(R.A,{name:"add"}),"Add URL"),d.createElement(A.A,{type:"button",onClick:function(){return x(e,vt)},icon:!0,className:"align-self-end add-button",labelPosition:"left",id:"".concat(t,".add-id-button")},d.createElement(R.A,{name:"add"}),"Add another identifier"))}})};At.propTypes={fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,required:f().bool,schemeOptions:f().arrayOf(f().shape({text:f().string,value:f().string})),showEmptyValue:f().bool};var Et=n(73083),yt=function(e){var t=e.updateQueryFilters,n=e.userSelectionFilters,r=e.filterValue,i=e.label,a=e.title,l=function(){t(n.concat([r]))},o=function(e){return e.filter((function(e){return e[1]===r[1]})).length>0}(n);return o?d.createElement(Et.A.Item,{name:i,active:!0,as:A.A,primary:!0,onClick:l},a):d.createElement(Et.A.Item,{name:i,onClick:l},a)};yt.propTypes={updateQueryFilters:f().func.isRequired,userSelectionFilters:f().array.isRequired,filterValue:f().array.isRequired,label:f().string.isRequired,title:f().string.isRequired};var Ft=(0,Be.Q2)((function(e){var t=e.currentResultsState,n=e.serializeLicenses,r=n||function(e){return{title:e.title_l10n,description:e.description_l10n,id:e.id}};return d.createElement(p.FastField,{name:"selectedLicense"},(function(e){var n=e.form,a=n.values,l=n.setFieldValue;return d.createElement(Ve.A.Group,null,t.data.hits.map((function(e){var t=e.title_l10n,n=e.description_l10n;return d.createElement(Ve.A,{key:t,onClick:function(){return l("selectedLicense",r(e))},className:"license-item mb-15"},d.createElement(He.A,(0,i.A)({checked:K()(a,"selectedLicense.title")===t,onChange:function(){return l("selectedLicense",r(e))}},!n&&{className:"mt-0"})),d.createElement(Ve.A.Content,{className:"license-item-content"},d.createElement($.A,{size:"small",className:"mt-0"},t),n&&d.createElement(Ve.A.Description,{className:"license-item-description"},n)))})))}))}));function wt(e,t,n){return t=(0,c.A)(t),(0,o.A)(e,Ct()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function Ct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ct=function(){return!!e})()}var Pt={"SearchFilters.Toggle":yt},Rt="standard",Mt="custom",Ot="add",kt=W.Ik().shape({selectedLicense:W.Ik().shape({title:W.Yj().required(v.M.t("Title is a required field.")),link:W.Yj().url(v.M.t("Link must be a valid URL"))})}),It=function(e){function t(){var e;(0,a.A)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=wt(this,t,[].concat(r)),(0,g.A)(e,"state",{open:!1}),(0,g.A)(e,"openModal",(function(){e.setState({open:!0})})),(0,g.A)(e,"closeModal",(function(){e.setState({open:!1}),e.props.focusAddButtonHandler(e.props.mode)})),(0,g.A)(e,"onSubmit",(function(t){var n=e.props.onLicenseChange;e.closeModal(),n(t.selectedLicense)})),e}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.mode,r=t.trigger,i=t.action,a=t.searchConfig,l=t.serializeLicenses,o=t.initialLicense,c=this.state.open,s=o||{title:"",description:"",id:null,link:""},u=new Be.HZ(a.searchApi);return d.createElement(p.Formik,{initialValues:{selectedLicense:s},onSubmit:this.onSubmit,validationSchema:kt,validateOnChange:!1,validateOnBlur:!1},(function(t){var o=t.handleSubmit,s=t.resetForm;return d.createElement(J.A,{onOpen:function(){return e.openModal()},open:c,trigger:r,onClose:e.closeModal,closeIcon:!0,closeOnDimmerClick:!1},d.createElement(J.A.Header,{as:"h6",className:"pt-10 pb-10"},d.createElement(h.A,null,d.createElement(h.A.Column,{floated:"left"},d.createElement($.A,{as:"h2"},i===Ot?v.M.t("Add {{mode}} license",{mode:n}):v.M.t("Change {{mode}} license",{mode:n}))))),d.createElement(J.A.Content,{scrolling:!0},n===Rt&&d.createElement(C.OverridableContext.Provider,{value:Pt},d.createElement(Be.gz,{searchApi:u,appName:"licenses",urlHandlerApi:{enabled:!1},initialQueryState:a.initialQueryState},d.createElement(h.A,null,d.createElement(h.A.Row,null,d.createElement(h.A.Column,{width:8,floated:"left",verticalAlign:"middle"},d.createElement(Be.IW,{placeholder:v.M.t("Search"),autofocus:!0,actionProps:{icon:"search",content:null,className:"search"}})),d.createElement(h.A.Column,{width:8,textAlign:"right",floated:"right"},d.createElement(Et.A,{compact:!0},d.createElement(Be.lM,{title:v.M.t("Recommended"),label:"recommended",filterValue:["tags","recommended"]}),d.createElement(Be.lM,{title:v.M.t("All"),label:"all",filterValue:["tags","all"]}),d.createElement(Be.lM,{title:v.M.t("Data"),label:"data",filterValue:["tags","data"]}),d.createElement(Be.lM,{title:v.M.t("Software"),label:"software",filterValue:["tags","software"]})))),d.createElement(h.A.Row,{verticalAlign:"middle"},d.createElement(h.A.Column,null,d.createElement(Be.oK,null,d.createElement(Be.i6,null),d.createElement(Be.$D,null),d.createElement(Ft,l&&{serializeLicenses:l}))))))),n===Mt&&d.createElement(P.A,null,d.createElement(b.TextField,{label:v.M.t("Title"),placeholder:v.M.t("License title"),fieldPath:"selectedLicense.title",required:!0}),d.createElement(b.TextAreaField,{fieldPath:"selectedLicense.description",label:v.M.t("Description")}),d.createElement(b.TextField,{label:v.M.t("Link"),placeholder:v.M.t("License link"),fieldPath:"selectedLicense.link"}))),d.createElement(J.A.Actions,null,d.createElement(A.A,{name:"cancel",onClick:function(){s(),e.closeModal()},icon:"remove",labelPosition:"left",content:v.M.t("Cancel"),floated:"left"}),d.createElement(A.A,{name:"submit",onClick:function(e){return o(e)},primary:!0,icon:"checkmark",labelPosition:"left",content:i===Ot?v.M.t("Add license"):v.M.t("Change license")})))}))}}])}(d.Component);It.propTypes={mode:f().oneOf(["standard","custom"]).isRequired,action:f().oneOf(["add","edit"]).isRequired,initialLicense:f().shape({id:f().string,title:f().string,description:f().string}),trigger:f().object.isRequired,onLicenseChange:f().func.isRequired,searchConfig:f().shape({searchApi:f().shape({axios:f().shape({headers:f().object})}).isRequired,initialQueryState:f().shape({filters:f().arrayOf(f().array)}).isRequired}).isRequired,serializeLicenses:f().func,focusAddButtonHandler:f().func},It.defaultProps={initialLicense:void 0,serializeLicenses:void 0};var St=n(92516),xt=n.n(St),qt=function(e){var t=e.license,n=e.moveLicense,i=e.replaceLicense,a=e.removeLicense,l=e.searchConfig,o=e.serializeLicenses,c=d.useRef(null),s=(0,Me.i)({item:{index:t.index,type:"license"}}),u=(0,r.A)(s,3),m=u[1],f=u[2],p=(0,Oe.H)({accept:"license",hover:function(e,r){if(c.current){var i=e.index,a=t.index;i!==a&&r.isOver({shallow:!0})&&(n(i,a),e.index=a)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),b=(0,r.A)(p,2),h=b[0].hidden;return(0,b[1])(c),d.createElement(ke.o,{innerRef:c,key:t.key},d.createElement(x.A.Item,{key:t.key,className:h?"deposit-drag-listitem hidden":"deposit-drag-listitem"},d.createElement(x.A.Content,{floated:"right"},d.createElement(It,{searchConfig:l,onLicenseChange:function(e){i(t.index,e)},mode:t.type,initialLicense:t.initial,action:"edit",trigger:d.createElement(A.A,{size:"mini",primary:!0,type:"button"},v.M.t("Change")),serializeLicenses:o}),d.createElement(A.A,{size:"mini",type:"button",icon:"close",onClick:function(){a(t.index)},"aria-label":v.M.t("Remove"),negative:!0})),d.createElement(ke.o,{innerRef:m},d.createElement(x.A.Icon,{name:"bars",className:"drag-anchor"})),d.createElement(ke.o,{innerRef:f},d.createElement(x.A.Content,null,d.createElement(x.A.Header,null,t.title),t.description&&d.createElement(x.A.Description,null,xt()(t.description,{length:300})),t.link&&d.createElement("span",null,d.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"license-read-more"},t.description&&v.M.t("Read more")))))))};function Dt(e,t,n){return t=(0,c.A)(t),(0,o.A)(e,Tt()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function Tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Tt=function(){return!!e})()}qt.propTypes={license:f().object.isRequired,moveLicense:f().func.isRequired,replaceLicense:f().func.isRequired,removeLicense:f().func.isRequired,searchConfig:f().object.isRequired,serializeLicenses:f().func},qt.defaultProps={serializeLicenses:void 0};var jt=(0,l.A)((function e(t,n,r){(0,a.A)(this,e),this.index=r,this.type=n.id?"standard":"custom",this.key=n.id||n.title,this.initial="custom"===this.type?n:null;var i=X()(t,n.id?function(e){return e.id===n.id}:function(e){return e.title===n.title})||{};this.description=i.description_l10n||n.description||"",this.title=i.title_l10n||n.title||"",this.link=i.props&&i.props.url||i.link||n.props&&n.props.url||n.link||""})),Lt=function(e){function t(){return(0,a.A)(this,t),Dt(this,t,arguments)}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.labelIcon,r=e.fieldPath,i=e.uiFieldPath,a=e.form.values,l=e.move,o=e.push,c=e.remove,s=e.replace,u=e.required,m=e.searchConfig,f=e.serializeLicenses,h=(0,p.getIn)(a,i,[]),g=function(e){document.getElementById("".concat(r,".add-").concat(e,"-button")).focus()};return d.createElement(P.A.Field,{required:u},d.createElement(b.FieldLabel,{htmlFor:r,icon:n,label:t}),d.createElement(x.A,null,(0,p.getIn)(a,r,[]).map((function(e,t){var n=new jt(h,e,t);return d.createElement(qt,{key:n.key,license:n,moveLicense:l,replaceLicense:s,removeLicense:c,searchConfig:m,serializeLicenses:f})})),d.createElement(It,{searchConfig:m,trigger:d.createElement(A.A,{type:"button",id:"".concat(r,".add-standard-button"),key:"standard",icon:!0,labelPosition:"left",className:"add-btn"},d.createElement(R.A,{name:"add"}),v.M.t("Add standard")),onLicenseChange:function(e){o(e)},mode:"standard",action:"add",serializeLicenses:f,focusAddButtonHandler:g}),d.createElement(It,{searchConfig:m,trigger:d.createElement(A.A,{type:"button",id:"".concat(r,".add-custom-button"),key:"custom",className:"add-btn",icon:!0,labelPosition:"left"},d.createElement(R.A,{name:"add"}),v.M.t("Add custom")),onLicenseChange:function(e){o(e)},mode:"custom",action:"add",focusAddButtonHandler:g})))}}])}(d.Component);Lt.propTypes={label:f().node.isRequired,labelIcon:f().node,fieldPath:f().string.isRequired,uiFieldPath:f().string,form:f().object.isRequired,move:f().func.isRequired,push:f().func.isRequired,remove:f().func.isRequired,replace:f().func.isRequired,required:f().bool.isRequired,searchConfig:f().object.isRequired,serializeLicenses:f().func},Lt.defaultProps={labelIcon:void 0,uiFieldPath:void 0,serializeLicenses:void 0};var zt=function(e){function t(){return(0,a.A)(this,t),Dt(this,t,arguments)}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return d.createElement(p.FieldArray,{name:t,component:function(t){return d.createElement(Lt,(0,i.A)({},t,e.props))}})}}])}(d.Component);zt.propTypes={fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,searchConfig:f().object.isRequired,required:f().bool,serializeLicenses:f().func,uiFieldPath:f().string},zt.defaultProps={label:v.M.t("Licenses"),uiFieldPath:"ui.rights",labelIcon:"drivers license",required:!1,serializeLicenses:void 0};var Nt=n(50363),_t=function(e){var t=e.filesEnabled,n=(0,p.useFormikContext)().setFieldValue;return d.createElement(Nt.A,{toggle:!0,label:"Metadata-only record",onChange:function(){n("files.enabled",!t),n("access.files","public")}})};_t.propTypes={filesEnabled:f().bool.isRequired};var Bt=function(e){var t=e.name,n=e.unit,r=e.value,i=e.options,a=e.position,l=e.useRange,o=e.fieldPath,c=e.handleDropdownChange,s=e.error;return d.createElement(P.A.Field,null,d.createElement(b.FieldLabel,{htmlFor:"".concat(o,".inputs.").concat(t),label:"".concat(l?v.M.t(a)+" ":"").concat(v.M.t(n)),id:"".concat(o,".").concat(t,".label")}),d.createElement(Je.A,{search:!0,selection:!0,id:"".concat(o,".inputs.").concat(t),name:t,options:i,value:r,onChange:c,error:s}))},Ut=function(e){var t=e.fieldPath,n=e.label,a=void 0===n?v.M.t("Publication Date"):n,l=e.labelIcon,o=void 0===l?"calendar":l,c=e.required,s=void 0===c||c,u="If this work is already published elsewhere, please use the date of the first publication.",m=(0,p.useFormikContext)(),f=m.setFieldValue,h=m.values,g=(m.touched,m.setFieldTouched),A=new Date,E=String(A.getFullYear()),y=String(A.getDate()).padStart(2,"0"),F=String(A.getMonth()+1).padStart(2,"0"),w=(0,d.useState)(E),C=(0,r.A)(w,2),R=C[0],M=C[1],O=(0,d.useState)(F),k=(0,r.A)(O,2),I=k[0],S=k[1],x=(0,d.useState)(y),q=(0,r.A)(x,2),D=q[0],T=q[1],j=(0,d.useState)(null),L=(0,r.A)(j,2),z=L[0],N=L[1],_=(0,d.useState)(null),B=(0,r.A)(_,2),U=B[0],V=B[1],H=(0,d.useState)(null),Y=(0,r.A)(H,2),Q=Y[0],K=Y[1],$=(0,d.useState)([R,I,D].join("-")),J=(0,r.A)($,2),W=(J[0],J[1]),Z=(0,d.useState)(!1),X=(0,r.A)(Z,2),ee=X[0],te=X[1];(0,d.useEffect)((function(){var e=h.metadata.publication_date;if(e){var t=function(e,t,n){M(e||null),S(t||null),T(n||null)};if(e.includes("/")){var n=e.split("/"),i=(0,r.A)(n,2),a=i[0],l=i[1],o=a.split("-"),c=(0,r.A)(o,3),s=c[0],d=c[1],u=c[2],m=l.split("-"),f=(0,r.A)(m,3),p=f[0],b=f[1],v=f[2];t(s,d,u),K(v),V(b),N(p)}else{var g=e.split("-"),A=(0,r.A)(g,3);t(A[0],A[1],A[2])}}}),[]),(0,d.useEffect)((function(){var e=[R,I,D].filter((function(e){return!!e})).join("-");z&&(e+="/"+[z,U,Q].filter((function(e){return!!e})).join("-")),W(e),f(t,e),g(t,!0)}),[R,I,D,z,U,Q]),(0,d.useEffect)((function(){ee||(N(null),V(null),K(null))}),[ee]);var ne=Array.from({length:E-1600+1},(function(e,t){return(1600+t).toString()})).map((function(e){return{key:e,value:e,text:e}})).reverse();ne.unshift({key:"None",value:null,text:"None"});var re=[{key:"None",value:null,text:"None",days:31},{key:"January",value:"01",text:"January",days:31},{key:"February",value:"02",text:"February",days:29},{key:"March",value:"03",text:"March",days:31},{key:"April",value:"04",text:"April",days:30},{key:"May",value:"05",text:"May",days:31},{key:"June",value:"06",text:"June",days:30},{key:"July",value:"07",text:"July",days:31},{key:"August",value:"08",text:"August",days:31},{key:"September",value:"09",text:"September",days:30},{key:"October",value:"10",text:"October",days:31},{key:"November",value:"11",text:"November",days:30},{key:"December",value:"12",text:"December",days:31}],ie=Array.from({length:31},(function(e,t){return(t+1).toString()})).map((function(e){return{key:e.padStart(2,"0"),value:e.padStart(2,"0"),text:e}}));ie.unshift({key:"None",value:null,text:"None"});var ae=re.find((function(e){return e.value===I})),le=ae?ae.days:31,oe=ie.slice(0,le+1),ce=function(e,t){var n=t.name,r=t.value;({startYear:M,startMonth:S,startDay:T,endYear:N,endMonth:V,endDay:K})[n](r),"startDay"!==n||I||S("01"),"endDay"!==n||U||V("01"),"startMonth"===n&&null===r&&T(null),"endMonth"===n&&null===r&&K(null),"startYear"===n&&null===r&&(S(null),T(null)),"endYear"===n&&null===r&&(V(null),K(null))},se=[{name:"startYear",unit:"Year",value:R,options:ne},{name:"startMonth",unit:"Month",value:I,options:re},{name:"startDay",unit:"Day",value:D,options:oe}],de=[{name:"endYear",unit:"Year",value:z,options:ne},{name:"endMonth",unit:"Month",value:U,options:re},{name:"endDay",unit:"Day",value:Q,options:oe}];return d.createElement(d.Fragment,null,d.createElement(p.Field,{name:t,id:t},(function(e){e.field;var n=e.form,r=(n.touched,n.errors,e.meta);return d.createElement(P.A.Field,{required:!!s,error:!!r.error},d.createElement(b.FieldLabel,{htmlFor:t,icon:o,label:a,id:"".concat(t,".label")}),d.createElement(P.A.Group,null,se.map((function(e,n){return d.createElement(Bt,(0,i.A)({key:n},e,{position:"Start",useRange:ee,fieldPath:t,handleDropdownChange:ce,error:!!r.error,"aria-describedby":"".concat(t,".help-text")}))})),d.createElement("div",null,d.createElement(Nt.A,{label:"".concat(ee?"include":"add"," end date"),id:"metadata.publication_date.controls.useRange",onChange:function(e,t){return te(t.checked)},checked:ee}))),!!ee&&d.createElement(P.A.Group,null,de.map((function(e,n){return d.createElement(Bt,(0,i.A)({key:n},e,{position:"End",useRange:ee,fieldPath:t,handleDropdownChange:ce,error:!!r.error,"aria-describedby":"".concat(t,".help-text")}))}))),r.error&&d.createElement(G.A,{className:"prompt error",pointing:!0},r.error),u&&d.createElement("div",{id:"".concat(t,".helptext"),className:"helptext"},u))})))};Ut.propTypes={fieldPath:f().string.isRequired,helpText:f().string,label:f().string,labelIcon:f().string,placeholder:f().string,required:f().bool};var Vt=["fieldPath","disabled","label","labelIcon","placeholder","helpText","required"],Ht=function(e){var t=e.fieldPath,n=(e.disabled,e.label),r=void 0===n?v.M.t("Publisher"):n,a=e.labelIcon,l=void 0===a?"building outline":a,o=e.placeholder,c=void 0===o?v.M.t("Publisher"):o,s=e.helpText,u=e.required,m=void 0!==u&&u,f=(0,H.A)(e,Vt);return d.createElement(oe.A,(0,i.A)({fieldPath:t,label:r,labelIcon:l,inputIcon:!0,placeholder:c,helpText:s,required:m,fluid:!0},f))};Ht.propTypes={fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,placeholder:f().string},Ht.defaultProps={};var Yt={scheme:"",identifier:"",resource_type:"",relation_type:""},Gt=function(e){var t=e.fieldPath,n=e.label,i=void 0===n?v.M.t("Related works"):n,a=e.labelIcon,l=void 0===a?"sitemap":a,o=e.required,c=void 0!==o&&o,s=e.options,u=(e.showEmptyValue,(0,p.useFormikContext)()),m=u.values,f=(u.setFieldValue,(0,d.useState)(-1)),h=(0,r.A)(f,2),g=h[0],E=h[1],y=(0,d.useState)(!1),F=(0,r.A)(y,2),w=F[0],C=F[1];(0,d.useEffect)((function(){var e,n;w&&(g<0?null===(e=document.getElementById("".concat(t,".add-button")))||void 0===e||e.focus():null===(n=document.getElementById("".concat(t,".").concat(g,".relation_type")))||void 0===n||n.focus())}),[g]);return d.createElement(p.FieldArray,{addButtonLabel:v.M.t("Add related work"),name:t,label:d.createElement(b.FieldLabel,{htmlFor:t,icon:l,label:i}),required:c,render:function(e){return d.createElement(d.Fragment,null,d.createElement(b.FieldLabel,{htmlFor:t,icon:l,label:i}),m.metadata.related_identifiers.map((function(n,r){n.relation_type,n.identifier,n.scheme,n.resource_type;var i="".concat(t,".").concat(r);return d.createElement(et.A,{key:r,fluid:!0,className:"additional-identifiers-item-row"},d.createElement(P.A.Group,null,d.createElement(b.SelectField,{clearable:!0,fieldPath:"".concat(i,".relation_type"),label:v.M.t("Relation"),optimized:!0,options:s.relations,placeholder:v.M.t("Select relation..."),required:!0,width:6}),d.createElement(b.TextField,{fieldPath:"".concat(i,".identifier"),label:v.M.t("Identifier"),required:!0,width:8}),d.createElement(P.A.Field,null,d.createElement(A.A,{"aria-label":v.M.t("Remove field"),className:"close-btn",icon:!0,onClick:function(){return function(e,t){C(!0),e.remove(t),E(g-1)}(e,r)},width:2},d.createElement(R.A,{name:"close"})))),d.createElement(P.A.Group,null,d.createElement(b.SelectField,{clearable:!0,fieldPath:"".concat(i,".scheme"),label:v.M.t("Scheme"),optimized:!0,options:s.scheme,required:!0,width:8}),d.createElement(Te.n,{clearable:!0,fieldPath:"".concat(i,".resource_type"),labelIcon:"",options:s.resource_type,labelclassname:"small field-label-class",width:8})))})),d.createElement(A.A,{type:"button",onClick:function(){return function(e,t){C(!0),e.push(t),E(g+1)}(e,Yt)},icon:!0,className:"align-self-end add-btn",labelPosition:"left",id:"".concat(t,".add-button")},d.createElement(R.A,{name:"add"}),"Add related work"),d.createElement("label",{className:"helptext",style:{marginBottom:"10px"}}))}})};function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $t(e,t,n){return t=(0,c.A)(t),(0,o.A)(e,Jt()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function Jt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Jt=function(){return!!e})()}Gt.propTypes={fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,required:f().bool,options:f().object.isRequired,showEmptyValue:f().bool};var Wt=function(e){function t(){var e;(0,a.A)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=$t(this,t,[].concat(r)),(0,g.A)(e,"state",{limitTo:"all"}),(0,g.A)(e,"serializeSubjects",(function(e){return e.map((function(e){return Kt(Kt({text:(e.scheme?"(".concat(e.scheme,") "):"")+e.subject,value:e.subject,key:e.subject},e.id?{id:e.id}:{}),{},{subject:e.subject})}))})),(0,g.A)(e,"prepareSuggest",(function(t){var n=e.state.limitTo,r="all"===n?"":"".concat(n,":");return"".concat(r).concat(t)})),e}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fieldPath,r=t.label,i=t.labelIcon,a=t.required,l=t.multiple,o=t.placeholder,c=t.clearable,s=t.limitToOptions,u=t.description;return d.createElement(d.Fragment,null,d.createElement(b.GroupField,{className:"main-group-field"},d.createElement(P.A.Field,{className:"subjects-field-inner",width:16},d.createElement(b.FieldLabel,{htmlFor:n,icon:i,label:r}),d.createElement(b.GroupField,{fluid:!0},d.createElement(p.Field,{name:n,width:10},(function(t){var r=t.form.values;return d.createElement(b.RemoteSelectField,{clearable:c,fieldPath:n,initialSuggestions:(0,p.getIn)(r,n,[]),multiple:l,noQueryMessage:v.M.t("Search subjects..."),placeholder:o,preSearchChange:e.prepareSuggest,suggestionAPIQueryParams:{type:"best_fields"},required:a,serializeSuggestions:e.serializeSubjects,serializeAddedValue:function(e){return{text:e,value:e,key:e,subject:e}},suggestionAPIUrl:"/api/subjects",onValueChange:function(e,t){e.formikProps.form.setFieldValue(n,t)},value:(0,p.getIn)(r,n,[]).map((function(e){return e.subject})),label:d.createElement(d.Fragment,null,d.createElement("label",{className:"mobile-hidden"},"\xa0")),allowAdditions:!1,width:11,"aria-describedby":"".concat(n,"-helpt-text"),helptext:u})})),d.createElement(P.A.Dropdown,{defaultValue:s[0].value,fluid:!0,onChange:function(t,n){return e.setState({limitTo:n.value})},options:s,selection:!0,width:6,label:v.M.t("From subject category...")})))))}}])}(d.Component);Wt.propTypes={limitToOptions:f().array.isRequired,fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,required:f().bool,multiple:f().bool,clearable:f().bool,placeholder:f().string,description:f().string},Wt.defaultProps={required:!1,label:v.M.t("Keywords and subjects"),labelIcon:"tag",multiple:!0,clearable:!0,placeholder:v.M.t("Search for a subject by name. (Press the 'enter' key to select)"),description:void 0};var Zt={lang:"",title:"",type:"alternative-title"},Xt={lang:"",title:"",type:"translated-title"},en=function(e){var t=e.fieldPath,n=e.options,i=e.recordUI,a=(0,p.useFormikContext)().values,l=(0,d.useState)(-1),o=(0,r.A)(l,2),c=o[0],s=o[1],u=(0,d.useState)(!1),m=(0,r.A)(u,2),f=m[0],h=m[1];(0,d.useEffect)((function(){var e,n;f&&(c<0?null===(e=document.getElementById("".concat(t,".add-translated-button")))||void 0===e||e.focus():null===(n=document.getElementById("".concat(t,".").concat(c,".title")))||void 0===n||n.focus())}),[c]);var g=function(e,t){h(!0),e.push(t),s(c+1)};return d.createElement(p.FieldArray,{addButtonLabel:v.M.t("Add other titles"),name:t,className:"additional-titles",render:function(e){return d.createElement(d.Fragment,null,a.metadata.additional_titles.map((function(r,a){var l,o="".concat(t,".").concat(a),u="translated-title"===r.type?"Translated":"Additional";return u="alternative-title"===r.type?"Alternative":u,d.createElement(P.A.Group,{key:a,className:"additional-titles-item-row"},d.createElement(b.TextField,{fieldPath:"".concat(o,".title"),label:"".concat(u," title"),id:"".concat(o,".title"),required:!0,width:7}),d.createElement(b.SelectField,{fieldPath:"".concat(o,".type"),label:"Type",id:"".concat(o,".type"),optimized:!0,options:n.type,required:!0,width:4}),d.createElement(Te.Km,{serializeSuggestions:function(e){return e.map((function(e){return{text:e.title_l10n,value:e.id,fieldPathPrefix:e.id}}))},initialOptions:null!==i&&void 0!==i&&i.additional_titles&&null!==(l=i.additional_titles[a])&&void 0!==l&&l.lang?[i.additional_titles[a].lang]:[],fieldPath:"".concat(o,".lang"),id:"".concat(o,".lang"),label:"Language",multiple:!1,placeholder:"",labelIcon:null,clearable:!0,selectOnBlur:!0,width:4}),d.createElement(P.A.Field,null,d.createElement(A.A,{"aria-label":v.M.t("Remove item"),className:"close-btn",icon:!0,onClick:function(){return function(e,t){h(!0),e.remove(t),s(c-1)}(e,a)}},d.createElement(R.A,{name:"close"}))))})),d.createElement(A.A,{type:"button",onClick:function(){return g(e,Xt)},icon:!0,className:"align-self-end add-btn",labelPosition:"left",id:"".concat(t,".add-translated-button")},d.createElement(R.A,{name:"add"}),"Add translated title"),d.createElement(A.A,{type:"button",onClick:function(){return g(e,Zt)},icon:!0,className:"align-self-end add-btn",labelPosition:"left",id:"".concat(t,".add-alternate-button")},d.createElement(R.A,{name:"add"}),"Add alternative title"))}})};en.propTypes={fieldPath:f().string.isRequired,options:f().shape({type:f().arrayOf(f().shape({icon:f().string,text:f().string,value:f().string})),lang:f().arrayOf(f().shape({text:f().string,value:f().string}))}),recordUI:f().object},en.defaultProps={options:void 0,recordUI:void 0};var tn=["fieldPath","options","label","required","recordUI","disabled"],nn=function(e){var t=e.fieldPath,n=void 0===t?"metadata.title":t,r=e.options,a=e.label,l=void 0===a?v.M.t("Title"):a,o=e.required,c=void 0!==o&&o,s=e.recordUI,u=void 0===s?void 0:s,m=e.disabled,f=void 0!==m&&m,p=(0,H.A)(e,tn);return d.createElement(d.Fragment,null,d.createElement(oe.A,(0,i.A)({fieldPath:n,label:l,required:c,classnames:"title-field",showLabel:!0,labelIcon:"book",disabled:f},p)),d.createElement(en,{options:r,recordUI:u,fieldPath:"metadata.additional_titles"}))};nn.propTypes={fieldPath:f().string.isRequired,label:f().string,options:f().shape({type:f().arrayOf(f().shape({icon:f().string,text:f().string,value:f().string})),lang:f().arrayOf(f().shape({text:f().string,value:f().string}))}).isRequired,required:f().bool,recordUI:f().object};var rn=["fieldPath","label","labelIcon","placeholder"],an=(T.x,function(e){var t=e.fieldPath,n=e.label,r=void 0===n?v.M.t("Version"):n,a=e.labelIcon,l=void 0===a?"code branch":a,o=e.placeholder,c=void 0===o?"":o,s=(0,H.A)(e,rn);return d.createElement(oe.A,(0,i.A)({fieldPath:t,label:d.createElement(b.FieldLabel,{htmlFor:t,icon:l,label:r}),placeholder:c},s))});an.propTypes={fieldPath:f().string.isRequired,label:f().string,labelIcon:f().string,placeholder:f().string};var ln=n(10467),on=n(54756),cn=n.n(on);function sn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dn(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){o=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(o)throw a}}}}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function un(e){return mn.apply(this,arguments)}function mn(){return(mn=(0,ln.A)(cn().mark((function e(t){return cn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.history.replaceState(void 0,"",t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fn=function(){var e=(0,ln.A)(cn().mark((function e(t,n){var r,i;return cn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!!t.id,e.next=3,n.save(t);case 3:return i=e.sent,r||un(i.data.links.self_html),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),pn=n(75497),bn=n(53959),hn=n(93682),vn=n(42755);function gn(e,t,n){return t=(0,c.A)(t),(0,o.A)(e,An()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function An(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(An=function(){return!!e})()}var En=function(e){var t=e.isDraftRecord;return d.createElement(bn.A.Header,null,d.createElement(bn.A.Row,null,d.createElement(bn.A.HeaderCell,null,v.M.t("Set as preview")," ",d.createElement(hn.A,{content:"Choose the file to be previewed by default on the record detail page.",trigger:d.createElement(R.A,{fitted:!0,name:"help circle",size:"small"})})),d.createElement(bn.A.HeaderCell,null,v.M.t("Filename")),d.createElement(bn.A.HeaderCell,null,v.M.t("Size")),t&&d.createElement(bn.A.HeaderCell,{textAlign:"center"},v.M.t("Progress")),t&&d.createElement(bn.A.HeaderCell,null)))};En.propTypes={isDraftRecord:f().bool},En.defaultProps={isDraftRecord:!1};var yn=function(e){var t,n,i,a,l,o=e.isDraftRecord,c=e.file,s=e.deleteFile,u=e.defaultPreview,m=e.setDefaultPreview,f=e.decimalSizeDisplay,p=(0,d.useState)(!1),h=(0,r.A)(p,2),g=h[0],E=h[1],y=(0,d.useState)(!1),F=(0,r.A)(y,2),w=F[0],C=F[1],P=u===c.name,M=function(){var e=(0,ln.A)(cn().mark((function e(t){return cn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.prev=1,e.next=4,s(t);case 4:P&&m(""),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return d.createElement(bn.A.Row,{key:c.name},d.createElement(bn.A.Cell,{"data-label":v.M.t("Default preview"),width:2},d.createElement(Nt.A,{checked:P,onChange:function(){return m(P?"":c.name)}})),d.createElement(bn.A.Cell,{"data-label":v.M.t("Filename"),width:10},d.createElement("div",null,c.uploadState.isPending?c.name:d.createElement("a",{href:K()(c,"links.content",""),target:"_blank",rel:"noopener noreferrer",className:"mr-5"},c.name),d.createElement("br",null),c.checksum&&d.createElement("div",{className:"ui text-muted"},d.createElement("span",{style:{fontSize:"10px"}},c.checksum)," ",d.createElement(hn.A,{content:v.M.t("This is the file fingerprint (MD5 checksum), which can be used to verify the file integrity."),trigger:d.createElement(R.A,{fitted:!0,name:"help circle",size:"small"}),position:"top center"})))),d.createElement(bn.A.Cell,{"data-label":v.M.t("Size"),width:2},c.size?(0,b.humanReadableBytes)(c.size,f):""),o&&d.createElement(bn.A.Cell,{className:"file-upload-pending","data-label":v.M.t("Progress"),width:2},!(null!==(t=c.uploadState)&&void 0!==t&&t.isPending)&&d.createElement(vn.A,{className:"file-upload-progress primary",percent:c.progressPercentage,error:c.uploadState.isFailed,size:"medium",progress:!0,autoSuccess:!0,active:!0}),(null===(n=c.uploadState)||void 0===n?void 0:n.isPending)&&d.createElement("span",null,v.M.t("Pending"))),o&&d.createElement(bn.A.Cell,{textAlign:"right",width:2},((null===(i=c.uploadState)||void 0===i?void 0:i.isFinished)||(null===(a=c.uploadState)||void 0===a?void 0:a.isFailed))&&(w?d.createElement(R.A,{loading:!0,name:"spinner"}):d.createElement(R.A,{link:!0,className:"action primary",name:"trash alternate outline",disabled:w,onClick:function(){return M(c)},"aria-label":v.M.t("Delete file"),title:v.M.t("Delete file")})),(null===(l=c.uploadState)||void 0===l?void 0:l.isUploading)&&d.createElement(A.A,{compact:!0,type:"button",negative:!0,size:"tiny",disabled:g,onClick:function(){return function(e){E(!0),e.cancelUploadFn()}(c)}},g?d.createElement(R.A,{loading:!0,name:"spinner"}):v.M.t("Cancel"))))};yn.propTypes={isDraftRecord:f().bool,file:f().object,deleteFile:f().func.isRequired,defaultPreview:f().string,setDefaultPreview:f().func.isRequired,decimalSizeDisplay:f().bool},yn.defaultProps={isDraftRecord:!1,file:void 0,defaultPreview:void 0,decimalSizeDisplay:!1};var Fn=function(e){var t=e.isDraftRecord,n=e.filesList,r=e.dragText,i=e.uploadButtonIcon,a=e.uploadButtonText,l=e.openFileDialog;return t&&d.createElement(et.A,{basic:!0,padded:"very",className:n.length?"file-upload-area":"file-upload-area no-files"},d.createElement(h.A,{columns:3,textAlign:"center"},d.createElement(h.A.Row,{verticalAlign:"middle"},d.createElement(h.A.Column,{mobile:16,tablet:7,computer:7},d.createElement($.A,{size:"small"},r)),d.createElement(h.A.Column,{className:"mt-10 mb-10",mobile:16,tablet:2,computer:2},"- ",v.M.t("or")," -"),d.createElement(h.A.Column,{mobile:16,tablet:7,computer:7},d.createElement(A.A,{type:"button",primary:!0,labelPosition:"left",icon:i,content:a,onClick:function(){return l()},disabled:null===l})))))};Fn.propTypes={isDraftRecord:f().bool.isRequired,filesList:f().array,dragText:f().string,uploadButtonIcon:f().node,uploadButtonText:f().string,openFileDialog:f().func},Fn.defaultProps={filesList:void 0,dragText:void 0,uploadButtonIcon:void 0,uploadButtonText:void 0,openFileDialog:null};var wn=function(e){var t=e.isDraftRecord,n=e.filesList,r=e.deleteFile,i=e.decimalSizeDisplay,a=(0,p.useFormikContext)(),l=a.setFieldValue,o=a.values,c=K()(o,"files.default_preview","");return d.createElement(bn.A,null,d.createElement(En,{isDraftRecord:t}),d.createElement(bn.A.Body,null,n.map((function(e){return d.createElement(yn,{key:e.name,isDraftRecord:t,file:e,deleteFile:r,defaultPreview:c,setDefaultPreview:function(e){return l("files.default_preview",e)},decimalSizeDisplay:i})}))))};wn.propTypes={isDraftRecord:f().bool,filesList:f().array,deleteFile:f().func,decimalSizeDisplay:f().bool},wn.defaultProps={isDraftRecord:void 0,filesList:void 0,deleteFile:void 0,decimalSizeDisplay:void 0};var Cn=function(e){function t(){return(0,a.A)(this,t),gn(this,t,arguments)}return(0,s.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.filesEnabled,r=t.dropzoneParams,a=t.filesList,l=t.isDraftRecord;return n||l?d.createElement(pn.Ay,r,(function(t){var n=t.getRootProps,r=t.getInputProps,l=t.open;return d.createElement(h.A.Column,{width:16},d.createElement("span",n(),d.createElement("input",r()),0!==a.length&&d.createElement(h.A.Column,{verticalAlign:"middle"},d.createElement(wn,e.props)),d.createElement(Fn,(0,i.A)({},e.props,{openFileDialog:l}))))})):d.createElement(h.A.Column,{width:16},d.createElement(et.A,{basic:!0,padded:"very",className:"file-upload-area no-files"},d.createElement(h.A,{textAlign:"center"},d.createElement(h.A.Row,{verticalAlign:"middle"},d.createElement(h.A.Column,null,d.createElement($.A,{size:"medium"},v.M.t("This is a Metadata-only record.")))))))}}])}(d.Component);Cn.propTypes={deleteFile:f().func,dragText:f().string,dropzoneParams:f().object,filesEnabled:f().bool.isRequired,filesList:f().array,isDraftRecord:f().bool,links:f().object,setDefaultPreviewFile:f().func,uploadButtonIcon:f().string,uploadButtonText:f().string,decimalSizeDisplay:f().bool},Cn.defaultProps={deleteFile:void 0,dragText:void 0,dropzoneParams:void 0,filesList:void 0,isDraftRecord:!1,links:void 0,setDefaultPreviewFile:void 0,uploadButtonIcon:void 0,uploadButtonText:void 0,decimalSizeDisplay:void 0};var Pn=function(e){var t=e.filesList,n=e.filesSize,r=e.filesEnabled,a=e.showMetadataOnlyToggle,l=e.quota,o=e.decimalSizeDisplay,c=(0,p.useFormikContext)().setFieldValue,s=function(){c("files.enabled",!r),c("access.files","public")};return d.createElement(C.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.layout",filesList:t,filesSize:n,filesEnabled:r,showMetadataOnlyToggle:a,quota:l,decimalSizeDisplay:o,handleOnChangeMetadataOnly:s},d.createElement(d.Fragment,null,a&&d.createElement(h.A.Column,{verticalAlign:"middle",floated:"left",mobile:16,tablet:6,computer:6},d.createElement(C.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.MetadataOnlyToggle.container",filesList:t,filesEnabled:r,showMetadataOnlyToggle:a,handleOnChangeMetadataOnly:s},d.createElement(x.A,{horizontal:!0},d.createElement(x.A.Item,null,d.createElement(Nt.A,{label:v.M.t("Metadata-only record"),onChange:s,disabled:t.length>0,checked:!r})),d.createElement(x.A.Item,null,d.createElement(hn.A,{trigger:d.createElement(R.A,{name:"question circle outline",className:"neutral"}),content:v.M.t("Disable files for this record"),position:"top center"}))))),d.createElement(C.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.FileList.container",filesList:t,filesSize:n,filesEnabled:r,quota:l,decimalSizeDisplay:o},r&&d.createElement(h.A.Column,{mobile:16,tablet:16,computer:16,className:"storage-col"},d.createElement(x.A,{horizontal:!0},d.createElement(x.A.Item,null,d.createElement(G.A,(0,i.A)({},t.length===l.maxFiles?{color:"orange"}:{color:"blue"},{image:!0}),d.createElement(R.A,{name:"zip"}),v.M.t("{{remaining}} out of {{maxfiles}}",{remaining:l.maxFiles-t.length,maxfiles:l.maxFiles}),d.createElement(G.A.Detail,null,v.M.t("max files left")))),d.createElement(x.A.Item,null,d.createElement(G.A,(0,i.A)({image:!0},(0,b.humanReadableBytes)(n,o)===(0,b.humanReadableBytes)(l.maxStorage,o)?{color:"orange"}:{color:"teal"}),d.createElement(R.A,{name:"pie chart"}),(0,b.humanReadableBytes)(l.maxStorage-n,o)," ",v.M.t("of")," ",(0,b.humanReadableBytes)(l.maxStorage,o),d.createElement(G.A.Detail,null," total storage left"))))))))};Pn.propTypes={filesList:f().array,filesSize:f().oneOfType([f().number,f().string]),filesEnabled:f().bool.isRequired,quota:f().object,decimalSizeDisplay:f().bool,showMetadataOnlyToggle:f().bool},Pn.defaultProps={filesList:void 0,filesSize:void 0,quota:void 0,decimalSizeDisplay:!1,showMetadataOnlyToggle:!0};var Rn=["config","fieldPath","files","isDraftRecord","hasParentRecord","label","labelIcon","noFiles","quota","permissions","record","uploadFiles","deleteFile","importParentFiles","importButtonIcon","importButtonText","isFileImportInProgress","decimalSizeDisplay"],Mn={uploading:"uploading",error:"error",finished:"finished",pending:"pending"},On=function(e){var t=e.config,n=e.fieldPath,a=void 0===n?"files":n,l=e.files,o=e.isDraftRecord,c=e.hasParentRecord,s=e.label,u=void 0===s?"Upload files":s,m=e.labelIcon,f=void 0===m?"upload":m,g=e.noFiles,E=void 0!==g&&g,y=e.quota,F=e.permissions,w=e.record,P=e.uploadFiles,M=e.deleteFile,O=e.importParentFiles,k=e.importButtonIcon,S=e.importButtonText,x=e.isFileImportInProgress,q=e.decimalSizeDisplay,D=(0,H.A)(e,Rn);console.log("FileUploaderComponent record",w),console.log("FileUploaderComponent isDraftRecord",o),console.log("FileUploaderComponent hasParentRecord",c),console.log("FileUploaderComponent uploadFiles",P),console.log("FileUploaderComponent deleteFile",M),console.log("FileUploaderComponent importParentFiles",O),console.log("FileUploaderComponent uiProps",D);var T=(0,p.useFormikContext)(),j=T.values,z=T.setFieldValue,N=K()(j,"files.enabled",!1);console.log("FileUploaderComponent filesEnabled",N);var _=(0,d.useState)(),B=(0,r.A)(_,2),U=B[0],V=B[1],Y=Object.values(l).map((function(e){return{name:e.name,size:e.size,checksum:e.checksum,links:e.links,uploadState:{isFailed:e.status===Mn.error,isUploading:e.status===Mn.uploading,isFinished:e.status===Mn.finished,isPending:e.status===Mn.pending},progressPercentage:e.progressPercentage,cancelUploadFn:e.cancelUploadFn}})),G=Y.reduce((function(e,t){return e+t.size}),0),Q={preventDropOnDocument:!0,onDropAccepted:function(e){var t=Y.length+e.length>y.maxFiles,n=e.reduce((function(e,t){return e+t.size}),0),r=G+n>y.maxStorage,i=te()(Y,"name"),a=e.filter((function(e){return i.includes(e.name)}));t?V(d.createElement("div",{className:"content"},d.createElement(L.A,{warning:!0,icon:"warning circle",header:"Could not upload files.",content:"Uploading the selected files would result in ".concat(Y.length+e.length," files (max.").concat(y.maxFiles,")")}))):r?V(d.createElement("div",{className:"content"},d.createElement(L.A,{warning:!0,icon:"warning circle",header:"Could not upload files.",content:d.createElement(d.Fragment,null,v.M.t("Uploading the selected files would result in")," ",(0,b.humanReadableBytes)(G+n,q),v.M.t("but the limit is"),(0,b.humanReadableBytes)(y.maxStorage,q),".")}))):I()(a)?W(j,e):V(d.createElement("div",{className:"content"},d.createElement(L.A,{warning:!0,icon:"warning circle",header:v.M.t("The following files already exist"),list:te()(a,"name")})))},multiple:!0,noClick:!0,noKeyboard:!0,disabled:!1};Y.length<y.maxFiles||(Q.disabled=!0);var $=N&&o&&c&&!Y.length;console.log("FileUploaderComponent displayImportBtn",$);var W=function(e,t){e.files.enabled=!0,z("files.enabled",!0),P(e,t)};return d.createElement(C.default,(0,i.A)({id:"ReactInvenioDeposit.FileUploader.layout",config:t,files:l,isDraftRecord:o,hasParentRecord:c,quota:y,label:u,labelIcon:f,permissions:F,record:w,uploadFiles:P,deleteFile:M,importParentFiles:O,importButtonIcon:k,importButtonText:S,isFileImportInProgress:x,decimalSizeDisplay:q,filesEnabled:N,filesList:Y,displayImportBtn:$,filesSize:G,dropzoneParams:Q,warningMsg:U,setWarningMsg:V},D),d.createElement(d.Fragment,null,d.createElement("label",{htmlFor:a,className:"field-label-class invenio-field-label"},f&&d.createElement("i",{className:"".concat(f," icon")}),u),d.createElement(h.A,null,d.createElement(C.default,(0,i.A)({id:"ReactInvenioDeposit.FileUploader.ImportButton.container",importButtonIcon:k,importButtonText:S,importParentFiles:O,isFileImportInProgress:x,displayImportBtn:$},D),$&&d.createElement(h.A.Row,{className:""},d.createElement(h.A.Column,{width:16},d.createElement(L.A,{visible:!0,info:!0},d.createElement("div",{style:{display:"inline-block",float:"right"}},d.createElement(A.A,{type:"button",size:"mini",primary:!0,icon:k,content:S,onClick:function(){return O()},disabled:x,loading:x})),d.createElement("p",{style:{marginTop:"5px",display:"inline-block"}},d.createElement(R.A,{name:"info circle"}),v.M.t("You can import files from the previous version.")))))),d.createElement(C.default,(0,i.A)({id:"ReactInvenioDeposit.FileUploader.FileUploaderArea.container",filesList:Y,dropzoneParams:Q,isDraftRecord:o,filesEnabled:N,deleteFile:M,decimalSizeDisplay:q},D),(N||o)&&d.createElement(h.A.Row,{className:"pb-0"},d.createElement(Cn,(0,i.A)({},D,{filesList:Y,dropzoneParams:Q,isDraftRecord:o,filesEnabled:N,deleteFile:M,decimalSizeDisplay:q})))),d.createElement(h.A.Row,{className:"pt-0 pb-5"},o&&d.createElement(Pn,(0,i.A)({},D,{config:t,filesEnabled:N,filesList:Y,filesSize:G,isDraftRecord:o,quota:y,decimalSizeDisplay:q}))),d.createElement(C.default,(0,i.A)({id:"ReactInvenioDeposit.FileUploader.NewVersionButton.container",isDraftRecord:o,permissions:F,record:w},D),o?d.createElement(h.A.Row,{className:"file-upload-note"},d.createElement(h.A.Column,{width:16},d.createElement(L.A,{visible:!0,warning:!0},d.createElement("p",null,d.createElement(R.A,{name:"warning sign"}),v.M.t("File addition, removal or modification are not allowed after you have published your upload."))))):d.createElement(h.A.Row,{className:"file-upload-note pt-5"},d.createElement(h.A.Column,{width:16},d.createElement(L.A,{info:!0},d.createElement(R.A,{name:"info circle",size:"large"}),d.createElement("p",{style:{marginTop:"5px",display:"inline-block"}},E&&w.is_published&&d.createElement("em",null,v.M.t("This published record has no files. ")),v.M.t("You must create a new version to add, modify or delete files.")),d.createElement(Te.z4,{record:w,onError:function(){},className:"",disabled:!F.can_new_version,style:{float:"right"}})))))),d.createElement(C.default,(0,i.A)({id:"ReactInvenioDeposit.FileUploader.Modal.container",warningMsg:U,setWarningMsg:V},D),d.createElement(J.A,{open:!!U,header:"Warning!",content:U,onClose:function(){return V()},closeIcon:!0}))))},kn=f().objectOf(f().shape({name:f().string,size:f().number,progressPercentage:f().number,checksum:f().string,links:f().object,cancelUploadFn:f().func,state:f().oneOf(Object.values(Mn)),enabled:f().bool}));On.propTypes={config:f().object,dragText:f().string,files:kn,isDraftRecord:f().bool,hasParentRecord:f().bool,quota:f().shape({maxStorage:f().number,maxFiles:f().number}),record:f().object,uploadButtonIcon:f().string,uploadButtonText:f().string,importButtonIcon:f().string,importButtonText:f().string,isFileImportInProgress:f().bool,importParentFiles:f().func.isRequired,uploadFiles:f().func.isRequired,deleteFile:f().func.isRequired,decimalSizeDisplay:f().bool,permissions:f().object},On.defaultProps={permissions:void 0,config:void 0,files:void 0,record:void 0,isFileImportInProgress:!1,dragText:v.M.t("Drag and drop files"),isDraftRecord:!0,hasParentRecord:!1,quota:{maxFiles:5,maxStorage:Math.pow(10,10)},uploadButtonIcon:"upload",uploadButtonText:v.M.t("Choose files"),importButtonIcon:"sync",importButtonText:v.M.t("Import files"),decimalSizeDisplay:!0};for(var In={"InvenioAppRdm.Deposit.AccessRightField.container":V,"InvenioAppRdm.Deposit.CreatorsField.container":De,"InvenioAppRdm.Deposit.ContributorsField.container":De,"InvenioAppRdm.Deposit.DescriptionsField.container":_e,"InvenioAppRdm.Deposit.FundingField.container":bt,"InvenioAppRdm.Deposit.IdentifiersField.container":At,"InvenioAppRdm.Deposit.LicenseField.container":zt,"ReactInvenioDeposit.MetadataOnlyToggle.layout":_t,"InvenioAppRdm.Deposit.PublicationDateField.container":Ut,"InvenioAppRdm.Deposit.PublisherField.container":Ht,"InvenioAppRdm.Deposit.RelatedWorksField.container":Gt,"InvenioAppRdm.Deposit.TitlesField.container":nn,"InvenioAppRdm.Deposit.VersionField.container":an,"InvenioAppRdm.Deposit.SubjectsField.container":Wt,"InvenioAppRdm.Deposit.FileUploader.container":(0,u.connect)((function(e){var t,n,r=e.files,i=r.links;return{files:r.entries,links:i,record:e.deposit.record,config:e.deposit.config,permissions:e.deposit.permissions,isFileImportInProgress:e.files.isFileImportInProgress,hasParentRecord:Boolean((null===(t=e.deposit.record)||void 0===t||null===(t=t.versions)||void 0===t?void 0:t.index)&&(null===(n=e.deposit.record)||void 0===n||null===(n=n.versions)||void 0===n?void 0:n.index)>1)}}),(function(e){return{uploadFiles:function(t,n){return e(function(e,t){return function(){var n=(0,ln.A)(cn().mark((function n(r,i,a){var l,o,c,s,d;return cn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("config"),console.log(a),n.prev=2,n.next=5,fn(e,a.service.drafts);case 5:l=n.sent,r({type:"DRAFT_FETCHED",payload:{data:l.data}}),o=l.data.links.files,c=sn(t);try{for(c.s();!(s=c.n()).done;)d=s.value,a.service.files.upload(o,d)}catch(i){c.e(i)}finally{c.f()}n.next=16;break;case 12:throw n.prev=12,n.t0=n.catch(2),r({type:"FILE_UPLOAD_SAVE_DRAFT_FAILED",payload:{errors:n.t0.errors}}),n.t0;case 16:case"end":return n.stop()}}),n,null,[[2,12]])})));return function(e,t,r){return n.apply(this,arguments)}}()}(t,n))},importParentFiles:function(){return e(function(){var e=(0,ln.A)(cn().mark((function e(t,n,r){var i,a,l;return cn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=n().deposit.record).id){e.next=3;break}return e.abrupt("return");case 3:return t({type:"FILE_IMPORT_STARTED"}),e.prev=4,a=i.links,e.next=8,r.service.files.importParentRecordFiles(a);case 8:l=e.sent,t({type:"FILE_IMPORT_SUCCESS",payload:{files:l}}),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(4),t({type:"FILE_IMPORT_FAILED"}),e.t0;case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n,r){return e.apply(this,arguments)}}())},deleteFile:function(t){return e(function(e){return function(){var t=(0,ln.A)(cn().mark((function t(n,r,i){var a;return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.links,t.next=4,i.service.files.delete(a);case 4:n({type:"FILE_DELETED_SUCCESS",payload:{filename:e.name}}),t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(0),n({type:"FILE_DELETE_FAILED"}),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t))}}}))(On),"InvenioModularDetailPage.MobileActionMenu.container":function(){return React.createElement("div",{className:"col-12"},React.createElement("h1",null,"HERE IT IS"))}},Sn=0,xn=Object.entries(In);Sn<xn.length;Sn++){var qn=(0,r.A)(xn[Sn],2),Dn=qn[0],Tn=qn[1];C.overrideStore.add(Dn,Tn)}},10182:(e,t,n)=>{n.d(t,{z:()=>u});var r=n(58168),i=n(80045),a=n(96540),l=n(17684),o=(n(62193),n(80501)),c=n(34667),s=n(81057),d=(n(2543),["defaultValue","error","errorDirection","fieldPath","label","labelIcon","onAddItem","onChange","optimized","options","multiple","required","selectOnBlur","width"]),u=function(e){var t=e.defaultValue,n=void 0===t?"":t,u=(e.error,e.errorDirection),m=void 0===u?"above":u,f=e.fieldPath,p=e.label,b=void 0===p?"":p,h=e.labelIcon,v=void 0===h?void 0:h,g=e.onAddItem,A=void 0===g?void 0:g,E=(e.onChange,e.optimized),y=void 0!==E&&E,F=e.options,w=e.multiple,C=void 0!==w&&w,P=(e.required,e.selectOnBlur),R=void 0!==P&&P,M=e.width,O=void 0===M?void 0:M,k=(0,i.A)(e,d),I=y?l.FastField:l.Field,S=(0,l.useFormikContext)().setFieldValue,x=function(e,t){var n=t.value;S(f,n)};return a.createElement(I,(0,r.A)({id:f,name:f,as:"select"},k),(function(e){var t=e.field,i=e.form,l=(i.touched,i.errors,e.meta);return a.createElement(o.A.Field,{error:!(!l.error||!l.touched)||void 0,width:O},a.createElement(s.FieldLabel,{htmlFor:f,icon:v,label:b}),a.createElement(c.A,(0,r.A)({className:"invenio-select-field",error:!(!l.error||!l.touched)||void 0,fluid:!0,id:f,multiple:C,name:f,options:F,selection:!0,selectOnBlur:R},t,k,{onChange:x,onAddItem:A,value:t.value||n})),l.error&&l.touched&&a.createElement("div",{className:"ui pointing above ".concat(m," prompt label "),role:"alert","aria-atomic":"true"},l.error))}))}},65466:(e,t,n)=>{n.d(t,{f:()=>m});var r=n(58168),i=n(80045),a=n(96540),l=n(17684),o=n(80501),c=n(81057),s=n(64383),d=["classnames","error","fieldPath","fluid","helpText","label","onBlur","optimized","required","rows","showLabel","width"],u=["customFieldsUI","currentResourceType","currentUserprofile","descriptionMods","defaultFieldValue","extraRequiredFields","fieldComponents","helpTextMods","icon","iconMods","inputIcon","labelIcon","labelMods","noFiles","placeholderMods","priorityFieldValues"],m=function(e){var t=e.classnames,n=e.error,m=e.fieldPath,f=(e.fluid,e.helpText),p=void 0===f?"":f,b=e.label,h=e.onBlur,v=e.optimized,g=void 0!==v&&v,A=e.required,E=void 0!==A&&A,y=e.rows,F=void 0===y?3:y,w=e.showLabel,C=void 0===w||w,P=e.width,R=(0,i.A)(e,d),M=(R.customFieldsUI,R.currentResourceType,R.currentUserprofile,R.descriptionMods,R.defaultFieldValue,R.extraRequiredFields,R.fieldComponents,R.helpTextMods,R.icon),O=(R.iconMods,R.inputIcon,R.labelIcon),k=(R.labelMods,R.noFiles,R.placeholderMods,R.priorityFieldValues,(0,i.A)(R,u)),I=g?l.FastField:l.Field;return a.createElement(I,{id:m,key:m,name:m,fieldPath:m,optimized:g},(function(e){var i=e.field,l=e.form,d=l.touched,u=(l.errors,l.values,e.meta),f=(0,s.$u)(d,m);return console.log("TextArea",m,u,f),a.createElement(o.A.Field,{required:!!E,error:!!u.error&&(!!u.touched||f)||!!n,className:"invenio-text-area-field ".concat(t),width:P},C&&a.createElement(c.FieldLabel,{htmlFor:m,icon:O||M,label:b}),a.createElement(o.A.TextArea,(0,r.A)({id:m,name:m,rows:F},p?{"aria-describedby":"".concat(m,".helptext")}:{},i,h&&{onBlur:function(e){h(e),i.onBlur(e)}},k)),(!!u.error&&(!!u.touched||f)||!!n)&&a.createElement(c.ErrorLabel,{fieldPath:m}),p&&a.createElement("label",{className:"helptext"},description))}))}},21095:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(58168),i=n(80045),a=n(96540),l=n(17684),o=n(80501),c=n(81057),s=n(11990),d=n(64383),u=["fieldPath","label","labelIcon","inputIcon","required","disabled","error","helpText","optimized","classnames","showLabel","fluid","onBlur","width"],m=["customFieldsUI","currentResourceType","currentUserprofile","descriptionMods","defaultFieldValue","extraRequiredFields","fieldComponents","helpTextMods","icon","iconMods","inputIcon","labelIcon","labelMods","noFiles","placeholderMods","priorityFieldValues"],f=function(e){var t=e.fieldPath,n=e.label,f=e.labelIcon,p=e.inputIcon,b=void 0===p||p,h=e.required,v=e.disabled,g=e.error,A=e.helpText,E=e.optimized,y=e.classnames,F=e.showLabel,w=void 0===F||F,C=e.fluid,P=void 0===C?"true":C,R=e.onBlur,M=e.width,O=(0,i.A)(e,u),k=E?l.FastField:l.Field,I=(O.customFieldsUI,O.currentResourceType,O.currentUserprofile,O.descriptionMods,O.defaultFieldValue,O.extraRequiredFields,O.fieldComponents,O.helpTextMods,O.icon,O.iconMods,O.inputIcon,O.labelIcon,O.labelMods,O.noFiles,O.placeholderMods,O.priorityFieldValues,(0,i.A)(O,m));return a.createElement(k,{id:t,name:t},(function(e){var i=e.field,l=e.form,u=l.touched,m=(l.errors,e.meta),p=(0,d.$u)(u,t);return a.createElement(o.A.Field,{required:!!h,error:!!m.error&&(!!m.touched||p)||!!g||!m.touched&&m.initialError,className:"invenio-text-input-field ".concat(y),fluid:P,width:M},w&&a.createElement(c.FieldLabel,{htmlFor:t,icon:f,label:n}),a.createElement(o.A.Input,(0,r.A)({error:m.error&&(m.touched||p)||!m.touched&&m.initialError?m.error:void 0,disabled:v,fluid:P,icon:b?f:void 0,id:t,name:t,"aria-describedby":"".concat(t,".helptext")},i,R&&{onBlur:function(e){R(e),i.onBlur(e)}},I)),A&&a.createElement("div",{className:"helptext",id:"".concat(t,".helptext")},s.M.t(A)))}))}},64383:(e,t,n)=>{n.d(t,{$u:()=>f,F1:()=>c,M$:()=>p,eH:()=>s,jj:()=>u,lq:()=>m,oG:()=>b,o_:()=>d});var r=n(82284),i=n(45458),a=n(17684);function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){window.scrollTo({top:0,left:0,behavior:"smooth"})}function s(e,t,n){var r,a=(0,i.A)(e),o=l(t);try{var c=function(){var e=r.value,t=a.findIndex((function(t){return t[n]===e}));a.unshift.apply(a,(0,i.A)(a.splice(t,1)))};for(o.s();!(r=o.n()).done;)c()}catch(s){o.e(s)}finally{o.f()}return a}function d(e,t,n){var r=(0,i.A)(e);return r.push.apply(r,(0,i.A)(r.splice(r.findIndex((function(e){return e[n]===t})),1))),r}function u(e){for(var t=Object.keys(e),n=[],i=function(i){var a=e[t[i]];if("object"!==(0,r.A)(a)||Array.isArray(a)||null===a)n.push(t[i]);else{var l=u(e[t[i]]).map((function(e){return"".concat(t[i],".").concat(e)}));n=n.concat(l)}},a=0;a<t.length;a++)i(a);return n}function m(e){var t=[];if(e.subsections){var n,r=l(e.subsections);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.subsections?t=t.concat(m(i)):t.push(i)}}catch(a){r.e(a)}finally{r.f()}}else t.push(e);return t}function f(e,t){for(var n=t.split("."),r=!1,i=n.length;i>1;i--){var l=n.slice(0,i).join(".");if(!0===(0,a.getIn)(e,l)){r=!0;break}}return r}function p(e,t,n){if(n&&(e=b(e,n),t=b(t,n)),e===t)return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((function(e,n){return p(e,t[n])}));if("object"===(0,r.A)(e)&&"object"===(0,r.A)(t)&&null!==e&&null!==t){if(Array.isArray(e)||Array.isArray(t))return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length||!i.every((function(e){return a.includes(e)})))return!1;for(var l in e){if(console.log(e[l],t[l]),!p(e[l],t[l]))return!1}return!0}return!1}function b(e,t){var n={};for(var r in e)t.includes(r)||(n[r]=e[r]);return n}}},e=>{e.O(0,[402,1057,7655,5373,6267,9777,5941,7501,4218,2222,8102,742,6528,3532],(()=>{return t=26441,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=overridable-registry.3ecdf79fa7bf25d51367.js.map