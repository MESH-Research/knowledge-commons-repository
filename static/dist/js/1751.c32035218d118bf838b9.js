"use strict";(self.webpackChunkinvenio_assets=self.webpackChunkinvenio_assets||[]).push([[1751],{91751:(e,n,t)=>{t.d(n,{q:()=>ae});var r=t(58168),i=t(64467),a=t(96540),l=t(5556),d=t.n(l),o=t(17684),u=t(8909),c=t(79551),s=t(80501),m=t(27859),f=t(3487),p=t(76217),g=t(81057),v=t(80296),b=t(11990),h=t(97177),A=t(65522),w=t(16147),F=t(28085),y=t(80045),E=t(98871),C=t(48423),O=t(1489),j=t(27089),z=t(15941),k=t(58156),P=t.n(k),R=t(23848),q=t(73591),M=t(27041),I=(0,E.Q2)((function(e){var n=e.currentResultsState,t=e.deserializeAward,r=e.deserializeFunder,i=e.computeFundingContents;return a.createElement(o.FastField,{name:"selectedFunding"},(function(e){var l=e.form,d=l.values,o=l.setFieldValue;return a.createElement(R.A.Group,null,n.data.hits.map((function(e){var n=null===e||void 0===e?void 0:e.funder,l=t(e),u={award:l,funder:r(n)},c=i(u),s=c.headerContent,m=c.descriptionContent,f=c.awardOrFunder;return a.createElement(R.A,{key:l.id,onClick:function(){return o("selectedFunding",u)},className:"license-item"},a.createElement(q.A,{checked:P()(d,"selectedFunding.award.id")===u.award.id,onChange:function(){return o("selectedFunding",u)}}),a.createElement(R.A.Content,{className:"license-item-content"},a.createElement(M.A,{size:"small"},s,"award"===f?e.number&&a.createElement(F.A,{basic:!0,size:"mini"},e.number):"","award"===f?e.url&&a.createElement("a",{href:"".concat(e.url),target:"_blank",rel:"noopener noreferrer"},a.createElement(p.A,{link:!0,name:"external alternate",className:"spaced-left"})):""),a.createElement(R.A.Description,{className:"license-item-description"},m)))})))}))}));I.propTypes={deserializeAward:d().func.isRequired,deserializeFunder:d().func.isRequired,computeFundingContents:d().func.isRequired};var S=t(62193),N=t.n(S);function T(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?T(Object(t),!0).forEach((function(n){(0,i.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function D(e){var n=e.deserializeFunder,t=e.selectedFunding;return a.createElement(s.A,null,a.createElement(g.RemoteSelectField,{fieldPath:"selectedFunding.funder.id",suggestionAPIUrl:"/api/funders",suggestionAPIHeaders:{Accept:"application/vnd.inveniordm.v1+json"},placeholder:b.M.t("Search for a funder by name"),serializeSuggestions:function(e){return e.map((function(e){return function(e){var n=null,t=null,r=null;return e.name&&(n=e.name),e.id&&(t=e.id),e.country&&(r=e.country),n||t?x(x({text:[n,r,t].filter((function(e){return e})).join(", "),value:e.id,key:e.id},n&&{name:n}),t&&{pid:t}):{}}(n(e))}))},searchInput:{autoFocus:N()(t)},label:b.M.t("Funder"),noQueryMessage:b.M.t("Search for funder..."),clearable:!0,allowAdditions:!1,multiple:!1,selectOnBlur:!1,selectOnNavigation:!1,required:!0,search:function(e){return e},isFocused:!0,onValueChange:function(e,n){var t,r=e.formikProps;if(1===n.length){var i=n[0];if(i){var a=x(x({id:(t=i).key},t.name&&{name:t.name}),t.pid&&{pid:t.pid});r.form.setFieldValue("selectedFunding.funder",a)}}}}),a.createElement(M.A,{as:"h3",size:"small"},b.M.t("Award information")," (",b.M.t("optional"),")"),a.createElement(s.A.Group,{widths:"equal"},a.createElement(g.TextField,{label:b.M.t("Number"),placeholder:b.M.t("Award number"),fieldPath:"selectedFunding.award.number"}),a.createElement(g.TextField,{label:b.M.t("Title"),placeholder:b.M.t("Award Title"),fieldPath:"selectedFunding.award.title"}),a.createElement(g.TextField,{label:b.M.t("URL"),placeholder:b.M.t("Award URL"),fieldPath:"selectedFunding.award.url"})))}D.propTypes={deserializeFunder:d().func.isRequired,selectedFunding:d().object},D.defaultProps={selectedFunding:void 0};const Q=D;var H=t(34667);function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function U(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(Object(t),!0).forEach((function(n){(0,i.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Y=(0,E.Q2)((function(e){var n=e.currentResultsState,t=e.updateQueryState,r=e.currentQueryState,i=function(e){var n=a.useState([]),t=(0,v.A)(n,2),r=t[0],i=t[1];return a.useEffect((function(){!function(){var n;if(e.loading)i([]);else{var t=null===(n=e.data.aggregations)||void 0===n||null===(n=n.funders)||void 0===n?void 0:n.buckets.map((function(e){return{key:e.key,value:e.key,text:e.label}}));i(t)}}()}),[e]),[r]}(n),l=(0,v.A)(i,1)[0];return a.createElement(H.A,{placeholder:b.M.t("Funder"),search:!0,selection:!0,clearable:!0,scrolling:!0,multiple:!1,options:l||[],allowAdditions:!1,onChange:function(e,n){var i=[];n&&""!==n.value&&(i=["funders",n.value]),t(U(U({},r),{},{filters:i,page:1}))},fluid:!0,selectOnBlur:!1,selectOnNavigation:!1})})),L=t(2685);function _(e){var n=e.switchToCustom;return a.createElement(L.A,{basic:!0,content:a.createElement("p",null,b.M.t("Did not find your award? "),a.createElement("a",{href:"/",onClick:function(e){e.preventDefault(),n()}},b.M.t("Add a custom award.")))})}_.propTypes={switchToCustom:d().func.isRequired};var V=["action","mode","trigger","onAwardChange","searchConfig","deserializeAward","deserializeFunder","computeFundingContents"],B="standard",G="custom",W="add",Z="edit",$=z.Ik().shape({selectedFunding:z.Ik().shape({funder:z.Ik().shape({id:z.Yj().required()}),award:z.Ik().shape({id:z.Yj().required()})})}),J=z.Ik().shape({selectedFunding:z.Ik().shape({funder:z.Ik().shape({id:z.Yj().required(b.M.t("Funder is required."))}),award:z.Ik().shape({title:z.Yj().test({name:"testTitle",message:b.M.t("Title must be set alongside number."),test:function(e){return!(this.parent.number&&!e)}}),number:z.Yj().test({name:"testNumber",message:b.M.t("Number must be set alongside title."),test:function(e){return!(this.parent.title&&!e)}}),url:z.Yj().url(b.M.t("URL must be valid.")).test({name:"validateUrlDependencies",message:b.M.t("URL must be set alongside title and number."),test:function(e){var n=this.parent,t=n.title,r=n.number;return!(e&&""!==e&&!t&&!r)}})})})});function X(e){var n=e.action,t=e.mode,r=e.trigger,i=e.onAwardChange,l=e.searchConfig,d=e.deserializeAward,u=e.deserializeFunder,c=e.computeFundingContents,s=(0,y.A)(e,V),m=(0,a.useState)(!1),p=(0,v.A)(m,2),g=p[0],h=p[1],A=(0,a.useState)(t),w=(0,v.A)(A,2),F=w[0],z=w[1],k=function(){return h(!0)},P=function(){z(t),h(!1)},R=new E.HZ(l.searchApi),q=F===G?s.initialFunding:{},M={selectedFunding:n===Z?q:{}},S=F===G?J:$;return a.createElement(o.Formik,{initialValues:M,onSubmit:function(e,n){n.setSubmitting(!1),n.resetForm(),z(t),P(),i(e.selectedFunding)},validationSchema:S,validateOnChange:!1,validateOnBlur:!1,enableReinitialize:!0},(function(e){var t=e.values,i=e.resetForm,o=e.handleSubmit;return a.createElement(C.A,{role:"dialog",centered:!1,onOpen:k,open:g,trigger:a.cloneElement(r,{"aria-expanded":g,"aria-haspopup":"dialog"}),onClose:P,closeIcon:!0,closeOnDimmerClick:!1},a.createElement(C.A.Header,{as:"h2",className:"pt-10 pb-10"},"standard"===F?b.M.t("Add standard award"):b.M.t("Add custom award")),a.createElement(C.A.Content,null,F===B&&a.createElement(E.gz,{searchApi:R,appName:"awards",urlHandlerApi:{enabled:!1},initialQueryState:l.initialQueryState},a.createElement(O.A,{className:"m-0"},a.createElement(O.A.Row,null,a.createElement(O.A.Column,{width:11,floated:"left",verticalAlign:"middle"},a.createElement(E.IW,{placeholder:b.M.t("Search for awards"),autofocus:!0,actionProps:{icon:"search",content:null,className:"search"}})),a.createElement(O.A.Column,{width:5,floated:"right",textAlign:"right"},a.createElement(Y,null))),a.createElement(O.A.Column,{width:16,className:"pb-0"},a.createElement(E.oK,null,a.createElement(E.i6,null),a.createElement(E.$D,null),a.createElement(I,{deserializeAward:d,deserializeFunder:u,computeFundingContents:c})),a.createElement(j.A,{textAlign:"center",className:"rel-mb-1"},a.createElement(E.dK,null))),a.createElement(O.A.Column,{width:16,textAlign:"center",className:"pt-0 pb-0"},a.createElement(_,{switchToCustom:function(){i(),z(G)}})))),F===G&&a.createElement(Q,{deserializeFunder:u,selectedFunding:t.selectedFunding})),a.createElement(C.A.Actions,null,a.createElement(f.A,{onClick:function(){i(),P()},icon:"remove",content:b.M.t("Cancel"),floated:"left"}),a.createElement(f.A,{onClick:function(e){return o(e)},primary:!0,icon:"checkmark",content:n===W?b.M.t("Add award"):b.M.t("Change award")})))}))}X.propTypes={mode:d().oneOf(["standard","custom"]).isRequired,action:d().oneOf(["add","edit"]).isRequired,trigger:d().object.isRequired,onAwardChange:d().func.isRequired,searchConfig:d().shape({searchApi:d().shape({axios:d().shape({headers:d().object})}).isRequired,initialQueryState:d().object.isRequired}).isRequired,deserializeAward:d().func.isRequired,deserializeFunder:d().func.isRequired,computeFundingContents:d().func.isRequired,initialFunding:d().object},X.defaultProps={initialFunding:void 0};const ee=X;var ne=function(e){var n,t,r=e.compKey,i=e.index,l=e.fundingItem,d=e.awardType,o=e.moveFunding,u=e.replaceFunding,c=e.removeFunding,s=e.searchConfig,g=e.deserializeAward,y=e.deserializeFunder,E=e.computeFundingContents,C=a.useRef(null),O=(0,h.i)({item:{index:i,type:"award"}}),j=(0,v.A)(O,3),z=(j[0],j[1]),k=j[2],P=(0,A.H)({accept:"award",hover:function(e,n){if(C.current){var t=e.index,r=i;t!==r&&n.isOver({shallow:!0})&&(o(t,r),e.index=r)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),R=(0,v.A)(P,2),q=R[0].hidden,M=R[1],I=E(l),S=I.headerContent,N=I.descriptionContent,T=I.awardOrFunder;return M(C),a.createElement(w.o,{innerRef:C,key:r},a.createElement(m.A.Item,{key:r,className:q?"deposit-drag-listitem hidden":"deposit-drag-listitem"},a.createElement(m.A.Content,{floated:"right"},a.createElement(ee,{searchConfig:s,onAwardChange:function(e){u(i,e)},mode:d,action:"edit",trigger:a.createElement(f.A,{size:"mini",primary:!0,type:"button"},b.M.t("Edit")),deserializeAward:g,deserializeFunder:y,computeFundingContents:E,initialFunding:l}),a.createElement(f.A,{size:"mini",type:"button",onClick:function(){return c(i)}},b.M.t("Remove"))),a.createElement(w.o,{innerRef:z},a.createElement(m.A.Icon,{name:"bars",className:"drag-anchor"})),a.createElement(w.o,{innerRef:k},a.createElement(m.A.Content,null,a.createElement(m.A.Header,null,a.createElement(a.Fragment,null,a.createElement("span",{className:"mr-5"},S),"award"===T?(null===l||void 0===l||null===(n=l.award)||void 0===n?void 0:n.number)&&a.createElement(F.A,{basic:!0,size:"mini",className:"mr-5"},l.award.number):"","award"===T?(null===l||void 0===l||null===(t=l.award)||void 0===t?void 0:t.url)&&a.createElement("a",{href:"".concat(l.award.url),target:"_blank",rel:"noopener noreferrer","aria-label":b.M.t("Open external link")},a.createElement(p.A,{link:!0,name:"external alternate"})):"")),a.createElement(m.A.Description,null,N||a.createElement("br",null))))))};function te(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function re(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?te(Object(t),!0).forEach((function(n){(0,i.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):te(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function ie(e){var n=e.label,t=e.labelIcon,r=e.fieldPath,i=e.form.values,l=e.move,d=e.push,v=e.remove,h=e.replace,A=e.required,w=e.deserializeAward,F=e.deserializeFunder,y=e.computeFundingContents,E=e.searchConfig,C=w||function(e){var n;return re(re({title:null===e||void 0===e?void 0:e.title_l10n,number:e.number,funder:null!==(n=e.funder)&&void 0!==n?n:"",id:e.id},e.identifiers&&{identifiers:e.identifiers}),e.acronym&&{acronym:e.acronym})},O=F||function(e){return re(re(re({id:e.id,name:e.name},e.pid&&{pid:e.pid}),e.country&&{country:e.country}),e.identifiers&&{identifiers:e.identifiers})},j=y||function(e){var n,t="",r="award";if(e.award&&(n=e.award.title),e.funder){var i,a,l,d,o,u,c=null!==(i=null!==(a=null!==(l=null===e||void 0===e||null===(d=e.funder)||void 0===d?void 0:d.name)&&void 0!==l?l:null===(o=e.funder)||void 0===o?void 0:o.title)&&void 0!==a?a:null===e||void 0===e||null===(u=e.funder)||void 0===u?void 0:u.id)&&void 0!==i?i:"";t=c,n||(r="funder",n=c,t="")}return{headerContent:n,descriptionContent:t,awardOrFunder:r}};return a.createElement(c.Q,{backend:u.t2},a.createElement(s.A.Field,{required:A},a.createElement(g.FieldLabel,{htmlFor:r,icon:t,label:n}),a.createElement(m.A,null,(0,o.getIn)(i,r,[]).map((function(e,n){var t,i="".concat(r,".").concat(n),d=null!==e&&void 0!==e&&null!==(t=e.award)&&void 0!==t&&t.id?"standard":"custom";return a.createElement(ne,{key:i,index:n,compKey:i,fundingItem:e,awardType:d,moveFunding:l,replaceFunding:h,removeFunding:v,searchConfig:E,computeFundingContents:j,deserializeAward:C,deserializeFunder:O})}))),a.createElement(ee,{searchConfig:E,trigger:a.createElement(f.A,{type:"button",key:"custom",icon:!0,labelPosition:"left",className:"mb-5"},a.createElement(p.A,{name:"add"}),b.M.t("Add award")),onAwardChange:function(e){d(e)},mode:"standard",action:"add",deserializeAward:C,deserializeFunder:O,computeFundingContents:j}),a.createElement(ee,{searchConfig:E,trigger:a.createElement(f.A,{type:"button",key:"custom",icon:!0,labelPosition:"left"},a.createElement(p.A,{name:"add"}),b.M.t("Add custom")),onAwardChange:function(e){d(e)},mode:"custom",action:"add",deserializeAward:C,deserializeFunder:O,computeFundingContents:j})))}function ae(e){var n=e.fieldPath;return a.createElement(o.FieldArray,{name:n,component:function(n){return a.createElement(ie,(0,r.A)({},n,e))}})}ne.propTypes={compKey:d().any,index:d().number,fundingItem:d().object,awardType:d().string,moveFunding:d().func.isRequired,replaceFunding:d().func.isRequired,removeFunding:d().func.isRequired,searchConfig:d().object.isRequired,deserializeAward:d().func.isRequired,deserializeFunder:d().func.isRequired,computeFundingContents:d().func.isRequired},ne.defaultProps={compKey:void 0,index:void 0,fundingItem:void 0,awardType:void 0},ie.propTypes={label:d().node,labelIcon:d().node,fieldPath:d().string.isRequired,form:d().object,move:d().func,push:d().func,remove:d().func,replace:d().func,required:d().bool,deserializeAward:d().func,deserializeFunder:d().func,computeFundingContents:d().func,searchConfig:d().object},ie.defaultProps={label:void 0,labelIcon:void 0,form:void 0,move:void 0,push:void 0,remove:void 0,replace:void 0,required:void 0,deserializeAward:void 0,deserializeFunder:void 0,computeFundingContents:void 0,searchConfig:void 0},ae.propTypes={fieldPath:d().string.isRequired,label:d().string,labelIcon:d().string,searchConfig:d().object.isRequired,required:d().bool,deserializeAward:d().func,deserializeFunder:d().func,computeFundingContents:d().func},ae.defaultProps={label:"Awards",labelIcon:"money bill alternate outline",required:!1,deserializeAward:void 0,deserializeFunder:void 0,computeFundingContents:void 0}}}]);
//# sourceMappingURL=1751.c32035218d118bf838b9.js.map